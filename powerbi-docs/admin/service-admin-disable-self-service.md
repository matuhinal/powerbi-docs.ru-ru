---
title: Включение и отключение самостоятельной регистрации и приобретения
description: Инструкции для администраторов по отключению возможности регистрации в службе Power BI и приобретения или продления лицензий для пользователей.
author: kfollis
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-admin
ms.topic: conceptual
ms.date: 04/08/2020
ms.author: kfollis
ms.custom: licensing support
LocalizationGroup: Administration
ms.openlocfilehash: 751db634ceb9e7d6349b35f7348b09e0c0d648ed
ms.sourcegitcommit: 3f864ec22f99ca9e25cda3a5abda8a5f69ccfa8e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2020
ms.locfileid: "84160072"
---
# <a name="enable-or-disable-self-service-sign-up-and-purchasing"></a>Включение и отключение самостоятельной регистрации и приобретения

В большинстве организаций самостоятельная регистрация по умолчанию включена. Отдельные пользователи в организации могут регистрироваться в Power BI с помощью своих рабочих или учебных учетных записей. Пользователям также может предлагаться возможность приобрести лицензию Power BI Pro при попытке использовать функцию, требующую такой лицензии. Администратор решает, следует ли включать или отключать самостоятельную регистрацию. Он также определяет, могут ли пользователи в организации самостоятельно покупать лицензии для себя.

> [!NOTE]
>Если вы приобрели Power BI через поставщика облачных решений Майкрософт (CSP), самостоятельная регистрация пользователей может быть заблокирована. Поставщик CSP также может выступать в роли глобального администратора вашей организации. В этом случае для изменения данного параметра потребуется обратиться к нему.
>
>

Для изменения параметров, контролирующих возможность самостоятельной регистрации и приобретения, используются команды PowerShell. Существует два параметра, которые определяют, могут ли пользователи в организации самостоятельно выполнять регистрацию или покупать лицензии.

- Чтобы полностью отключить возможность самостоятельной регистрации, измените в Azure Active Directory параметр **AllowAdHocSubscriptions** с помощью команд Azure AD PowerShell. Чтобы [включить или отключить самостоятельную регистрацию](#enable-or-disable-self-service-signup), выполните инструкции, описанные в этой статье. Этот параметр отключает самостоятельную регистрацию для *всех* облачных приложений и служб Майкрософт.

- Чтобы запретить пользователям самостоятельно покупать лицензии Pro, измените параметр **AllowSelfServicePurchase** с помощью команд MSCommerce в PowerShell. Этот параметр позволяет отключить самостоятельное приобретение для отдельных продуктов. Чтобы [включить или отключить самостоятельное приобретение лицензий Power BI Pro](#enable-or-disable-self-service-purchase), выполните инструкции, описанные в этой статье.

## <a name="enable-or-disable-self-service-signup"></a>Включение и отключение самостоятельной регистрации

Когда самостоятельная регистрация включена, параметр **AllowAdHocSubscriptions** имеет значение *true*. Давайте посмотрим, что произойдет, если изменить его на *false*.

- При изменении значения параметра с true на false новые пользователи в вашей организации не смогут регистрироваться индивидуально. Пользователи, которые зарегистрировались в Power BI до изменения этого параметра, сохраняют свои лицензии.

- При изменении значения на false пользователи, у которых уже есть лицензия Power BI (бесплатная версия), по-прежнему могут регистрироваться для получения пробной версии Power BI Pro для частных лиц.

- Администратору необходимо назначить лицензии Power BI всем новым пользователям, которым они нужны.

### <a name="before-you-begin"></a>Подготовка

В этих инструкциях для изменения значения параметра **AllowAdHocSubscriptions** используются команды PowerShell для Azure Active Directory. Чтобы они стали доступны, необходимо установить модуль PowerShell для Azure AD. Дополнительные сведения об использовании PowerShell см. в статье [Начало работы с Windows PowerShell](https://docs.microsoft.com/powershell/scripting/getting-started/getting-started-with-windows-powershell?view=powershell-7).

Чтобы установить модуль Azure AD, запустите Windows PowerShell от имени администратора. Убедитесь в том, что локальная политика выполнения позволяет выполнять скрипты. Если возникли проблемы, см. раздел [Политики выполнения PowerShell](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7#powershell-execution-policies), чтобы узнать, как изменить локальную политику.

Чтобы установить модуль Azure AD, выполните следующую команду.

```powershell
Install-Module MSOnline
```

### <a name="change-the-self-service-signup-policy"></a>Изменение политики самостоятельной регистрации

В PowerShell выполните следующую команду, чтобы подключиться к Azure AD.

```powershell
Connect-MsolService
```

Введите учетные данные администратора в диалоговом окне входа и при необходимости пройдите двухфакторную проверку подлинности. После проверки вы вернетесь в окно PowerShell.

Чтобы просмотреть текущее значение параметра, выполните указанную ниже команду. Выходные данные передаются в отформатированный список с помощью параметра fl.

```powershell
Get-MsolCompanyInformation | fl AllowAdHocSubscriptions
```

Чтобы изменить текущее значение, выполните указанную ниже команду.

```powershell
Set-MsolCompanySettings -AllowAdHocSubscriptions $false
```

После выполнения этой команды самостоятельная регистрация отключается для всех пользователей. Чтобы снова включить ее, выполните эту команду еще раз, задав значение $true.

## <a name="enable-or-disable-self-service-purchase"></a>Включение и отключение самостоятельного приобретения

Если самостоятельное приобретение включено, параметр **AllowSelfServicePurchase** имеет значение *true*. Давайте посмотрим, что произойдет, если изменить его на *false*.

- При изменении значения параметра с true на false пользователи в организации не смогут самостоятельно покупать лицензии Power BI Pro. Пользователи, которые купили лицензии до изменения этого параметра, сохраняют свои лицензии.

- При изменении значения на false пользователи, у которых есть лицензия Power BI (бесплатная версия), не могут получать лицензии Power BI Pro для частных лиц. 

- Администратору необходимо назначить лицензии Pro всем пользователям, которым они нужны.

### <a name="before-you-begin"></a>Подготовка

В этих инструкциях для изменения значения параметра **AllowSelfServicePurchase** используются команды MSCommerce в PowerShell. Чтобы они стали доступны, необходимо установить модуль MSCommerce PowerShell. Дополнительные сведения об использовании PowerShell см. в статье [Начало работы с Windows PowerShell](https://docs.microsoft.com/powershell/scripting/getting-started/getting-started-with-windows-powershell?view=powershell-7).

Чтобы установить модуль MSCommerce, запустите Windows PowerShell от имени администратора. Убедитесь в том, что локальная политика выполнения позволяет выполнять скрипты. Если возникли проблемы, см. раздел [Политики выполнения PowerShell](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7#powershell-execution-policies), чтобы узнать, как изменить локальную политику.

Чтобы установить модуль MSCommerce, выполните следующую команду:

```powershell
Install-Module -name MSCommerce
```

### <a name="change-the-self-service-signup-policy"></a>Изменение политики самостоятельной регистрации

В PowerShell выполните следующую команду, чтобы подключиться.

```powershell
Connect-MSCommerce
```

Введите учетные данные администратора в диалоговом окне входа и при необходимости пройдите двухфакторную проверку подлинности. После проверки в окне PowerShell отобразится успешное соединение.

Чтобы просмотреть текущее значение параметра, выполните указанную ниже команду. Чтобы предотвратить усечение текста, выходные данные передаются в отформатированный список с помощью параметра fl.

```powershell
Get-MSCommercePolicy -PolicyId AllowSelfServicePurchase | fl
```

Вы можете отключить параметр, который разрешает самостоятельное приобретение для отдельного продукта, указав его идентификатор **ProductId**. Чтобы изменить текущее значение для службы Power BI, выполните следующую команду.

```powershell
Update-MSCommerceProductPolicy -PolicyId AllowSelfServicePurchase -ProductId CFQ7TTC0L3PB -Enabled $False
```

После выполнения этой команды самостоятельное приобретение лицензий Power BI отключается для всех пользователей. Чтобы снова включить ее, выполните эту команду еще раз, задав значение $true.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о самостоятельном приобретении лицензий на Power BI и другие службы Power Platform см. в следующих статьях:

- [Вопросы и ответы по самостоятельной покупке](https://docs.microsoft.com/microsoft-365/commerce/subscriptions/self-service-purchase-faq?view=o365-worldwide#admin-capabilities)
- [Использование параметра AllowSelfServicePurchase для модуля MSCommerce PowerShell](https://docs.microsoft.com/microsoft-365/commerce/subscriptions/allowselfservicepurchase-powershell?view=o365-worldwide)
