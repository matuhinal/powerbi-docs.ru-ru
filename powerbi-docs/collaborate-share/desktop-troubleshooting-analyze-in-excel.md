---
title: Устранение неполадок с анализом в Excel в Power BI Desktop
description: Решения распространенных проблем анализа в Excel
author: davidiseminger
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: troubleshooting
ms.date: 01/29/2020
ms.author: davidi
LocalizationGroup: Troubleshooting
ms.openlocfilehash: 555d203cfa8bd00e745c0dcff5de7f7e8d48f06c
ms.sourcegitcommit: a72567f26c1653c25f7730fab6210cd011343707
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2020
ms.locfileid: "83563191"
---
# <a name="troubleshooting-analyze-in-excel"></a>Устранение неполадок с анализом в Excel

В некоторых случаях функция анализа в Excel дает неожиданный результат или работает не так, как нужно. На этой странице представлены решения наиболее распространенных проблем, возникающих при работе с анализом в Excel.

> [!NOTE]
> Функция [анализа в Excel](service-analyze-in-excel.md) и процедура ее активации описаны на отдельной странице.
> 
> Если возникла проблемная ситуация, не указанная ниже, вы можете запросить дополнительную помощь на [сайте сообщества](https://community.powerbi.com/) или отправить [запрос в службу поддержки](https://powerbi.microsoft.com/support/).
> 
> 

Эта статья содержит следующие разделы по устранению неполадок:

* Обновление библиотек Excel для поставщика OLE DB
* Определение необходимости в обновлении библиотек Excel
* Ошибка невозможности подключения
* Ошибка запрета на доступ
* Отсутствуют модели данных
* Ошибка истечения срока действия токена
* Не удается подключиться к локальным службам Analysis Services
* Не удается перетащить элементы в область значений сводной таблицы (без мер)

## <a name="update-excel-libraries-for-the-ole-db-provider"></a>Обновление библиотек Excel для поставщика OLE DB
Для использования функции **анализа в Excel** на компьютере должен быть установлен текущий поставщик OLE DB AS. Этот [пост сообщества](https://community.powerbi.com/t5/Service/Analyze-in-Excel-Initialization-of-the-data-source-failed/m-p/30837#M8081) — отличное средство для проверки установки поставщика OLE DB, а также источник для загрузки последней версии.

Библиотеки Excel и ваша версия Windows должны иметь одинаковую разрядность. Если у вас установлена 64-разрядная версия Windows, установите 64-разрядную версию поставщика OLE DB.

Чтобы загрузить последние библиотеки Excel, зайдите в Power BI и в правом верхнем углу службы щелкните **стрелку вниз**, а затем выберите **Обновления анализа в Excel**.

![](media/desktop-troubleshooting-analyze-in-excel/tshoot-analyze-excel_1.png)

В открывшемся диалоговом окне выберите **Скачать (предварительная версия)** .

![](media/desktop-troubleshooting-analyze-in-excel/tshoot-analyze-excel_2.png)

## <a name="determining-whether-you-need-to-update-your-excel-libraries"></a>Определение необходимости в обновлении библиотек Excel
Последнюю версию библиотеки поставщиков OLE DB для Excel можно скачать по ссылкам, указанным в предыдущем разделе. После загрузки соответствующей библиотеки поставщика OLD DB и начала установки система проверит установку текущей версии.

Если клиентские библиотеки поставщиков OLE DB для Excel актуальны, откроется диалоговое окно следующего вида:

![](media/desktop-troubleshooting-analyze-in-excel/troubleshoot-analyze-excel_3.png)

Если устанавливаемая версия новее версии, уже установленной на вашем компьютере, откроется следующее диалоговое окно:

![](media/desktop-troubleshooting-analyze-in-excel/troubleshoot-analyze-excel_2.png)

Если появляется диалоговое окно с предложением установить обновление, необходимо продолжить установку и получить последнюю версию поставщика OLE DB, установленного на вашем компьютере.

## <a name="connection-cannot-be-made-error"></a>Ошибка невозможности подключения
Основная причина возникновения ошибки *Не удается установить подключение* связана с тем, что клиентские библиотеки поставщика OLE DB на вашем компьютере устарели. Сведения о том, как определить необходимую версию обновления, а также ссылки на загрузку см. в разделе **Обновление библиотек Excel для поставщика OLE DB** выше в этой статье.

## <a name="forbidden-error"></a>Ошибка запрета на доступ
Некоторые пользователи имеют более одной учетной записи Power BI, и при попытке подключения к Power BI Excel может использовать учетные данные, не имеющие доступа к нужному вам набору данных или отчету.

В этом случае может возникнуть ошибка **Запрещено**, которая может указывать на то, что вы вошли в Power BI под учетными данными, не позволяющими получить доступ к набору данных. При получении ошибки **Запрещено** введите в соответствующие поля учетные данные, позволяющие получить доступ к необходимому вам набору данных.

Если ошибка повторяется, войдите в Power BI под учетной записью, имеющей разрешение, и убедитесь, что вы можете просматривать и открывать набор данных в Power BI, к которому вы хотите получить доступ в Excel.

## <a name="no-data-models"></a>Отсутствуют модели данных
Если возникнет сообщение об ошибке **Не удается найти кубическую модель OLAP**, то набор данных, к которому вы пытаетесь получить доступ, не содержит модели данных, а значит, не может быть проанализирован в Excel.

## <a name="token-expired-error"></a>Ошибка истечения срока действия токена
Если возникает ошибка **Срок действия токена истек**, значит, вы давно не пользовались функцией **Анализ в Excel** на своем компьютере. Просто введите свои учетные данные или откройте файл, и ошибка исчезнет.

## <a name="unable-to-access-on-premises-analysis-services"></a>Не удается подключиться к локальным службам Analysis Services
При попытке обратиться к набору данных, в котором есть подключения к локальным данным служб Analysis Services, может появляться сообщение об ошибке. Функция **Анализ в Excel** поддерживает подключение к наборам данных и отчетам в локальных **службах Analysis Services** с помощью строки подключения, если ваш компьютер входит в тот же домен, что и сервер **служб Analysis Services**, а ваша учетная запись имеет доступ к этому серверу **служб Analysis Services**.

## <a name="cant-drag-anything-to-the-pivottable-values-area-no-measures"></a>Не удается перетащить элементы в область значений сводной таблицы (без мер)
Когда функция **Анализ в Excel** подключается к внешней модели OLAP (именно так Excel подключается к Power BI), для *сводной таблицы* [необходимо определить **меры** во внешней модели](https://support.microsoft.com/kb/234700), так как все вычисления выполняются на сервере. В этом заключается различие в работе с локальным источником данных (например, с таблицами в Excel или с наборами данных в **Power BI Desktop** или **службе Power BI**), когда табличная модель доступна локально и [можно использовать неявные меры](https://support.microsoft.com/en-us/office/measures-in-power-pivot-86484821-a324-4da3-803b-82fd2e5033f4), которые создаются динамически и не хранятся в модели данных. В этих случаях работа в Excel отличается от работы в **Power BI Desktop** или **службе Power BI**: в данных могут существовать столбцы, которые можно рассматривать как меры в Power BI, но нельзя использовать как значения (меры) в Excel.

Чтобы устранить эту проблему, можно воспользоваться такими вариантами:

1. Создайте [меры в модели данных в **Power BI Desktop**](../transform-model/desktop-tutorial-create-measures.md), затем опубликуйте модель данных в **службе Power BI** и получите доступ к опубликованному набору данных через Excel.
2. Создайте [меры в модели данных в Excel PowerPivot](https://support.office.com/article/Create-a-Measure-in-Power-Pivot-d3cc1495-b4e5-48e7-ba98-163022a71198).
3. Если данные были импортированы из книги Excel, в которой содержались только таблицы (без модели данных), то можно [добавить таблицы в модель данных](https://support.office.com/article/Add-worksheet-data-to-a-Data-Model-using-a-linked-table-d3665fc3-99b0-479d-ba09-a37640f5be42), а затем выполнить действия из варианта 2 выше, чтобы создать меры в модели данных.

После определения мер в модели в службе Power BI можно использовать их в области **Значения** в сводных таблицах Excel.

## <a name="next-steps"></a>Дальнейшие действия
[Analyze in Excel](service-analyze-in-excel.md) (Анализ в Excel)

[Руководство. Создание собственных мер в Power BI Desktop](../transform-model/desktop-tutorial-create-measures.md)

[Меры в PowerPivot](https://support.microsoft.com/en-us/office/measures-in-power-pivot-86484821-a324-4da3-803b-82fd2e5033f4)

[Создание меры в PowerPivot](https://support.office.com/article/Create-a-Measure-in-Power-Pivot-d3cc1495-b4e5-48e7-ba98-163022a71198)

[Добавление данных листа в модель данных с помощью связанной таблицы](https://support.office.com/article/Add-worksheet-data-to-a-Data-Model-using-a-linked-table-d3665fc3-99b0-479d-ba09-a37640f5be42)
