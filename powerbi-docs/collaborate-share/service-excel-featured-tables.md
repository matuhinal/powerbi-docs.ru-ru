---
title: Доступ к рекомендуемым таблицам Power BI в Excel (предварительная версия)
description: В Excel можно использовать данные из рекомендуемых таблиц в наборах данных Power BI в коллекции "Типы данных".
author: maggiesMSFT
ms.reviewer: lukaszp
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: how-to
ms.date: 07/24/2020
ms.author: maggies
LocalizationGroup: Share your work
ms.openlocfilehash: 00fba391a6ad92f1e3edaf0e2af9691452724f6e
ms.sourcegitcommit: 65025ab7ae57e338bdbd94be795886e5affd45b4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2020
ms.locfileid: "87251651"
---
# <a name="access-power-bi-featured-tables-in-excel-preview"></a>Доступ к рекомендуемым таблицам Power BI в Excel (предварительная версия)

В Excel в коллекции типов данных находятся данные из *рекомендуемых таблиц* в наборах данных Power BI. Рекомендуемые таблицы упрощают добавление корпоративных данных на листы Excel. Ниже приведены инструкции по получению данных Power BI на листы Excel.

- Средство моделирования данных Power BI [повышает уровень набора данных или удостоверяет их в Power BI](../connect-data/service-datasets-promote.md).
- Средство моделирования данных [определяет основные таблицы](service-create-excel-featured-tables.md) в наборе данных и сохраняет этот набор данных в службе Power BI.
- Остальные пользователи организации могут подключаться к этим рекомендуемым таблицам в Excel, для получения актуальных и обновляемых данных. Excel ссылается на эти таблицы как на *типы данных* и перечисляет их в коллекции типов данных.

> [!NOTE]
> В Excel можно получить данные из любого набора данных, доступного в Power BI. На ленте **Данные** выберите **Получить данные** > **Из Power BI (Майкрософт)** .
> :::image type="content" source="media/service-excel-featured-tables/excel-get-data-power-bi.png" alt-text="Снимок экрана: параметр Получить данные из Power BI на ленте Данные.":::

## <a name="the-excel-data-types-gallery"></a>Коллекция "Типы данных" в Excel
Рекомендуемые таблицы в наборах данных Power BI отображаются в Excel на вкладке **Данные** в коллекции **Типы данных** как *типы данных*.

:::image type="content" source="media/service-excel-featured-tables/excel-data-ribbon.png" alt-text="Снимок экрана: коллекция Типы данных на ленте Данные в Excel.":::

При развертывании в коллекции отображаются универсальные типы данных, такие как **Акции** и **География**, а также первые 10 типов данных **Организация** —рекомендуемые таблицы из наборов данных Power BI.

:::image type="content" source="media/service-excel-featured-tables/excel-data-types-gallery.png" alt-text="Снимок экрана: коллекция Типы данных в Excel.":::

## <a name="format-a-range-of-cells-as-a-table-optional"></a>Форматирование диапазона ячеек в виде таблицы (необязательно)

 Перед началом работы рекомендуется отформатировать данные в виде таблицы Excel. Таким образом, изменения, вносимые в одну строку, будут применяться к другим строкам в таблице. 

1. Добавьте заголовок столбца. 
2. Затем выберите ячейку в данных и нажмите клавиши CTRL + T. 
3. Выберите **Таблица с заголовками** > **ОК**.

    :::image type="content" source="media/service-excel-featured-tables/excel-format-table.png" alt-text="Снимок экрана: преобразование диапазона в таблицу.":::

## <a name="search-for-power-bi-data-in-the-excel-data-types-gallery"></a>Поиск данных Power BI с помощью коллекции "Типы данных" в Excel

Чтобы найти данные в таблице Power BI, выберите ячейку или диапазон на листе Excel, содержащий значение, совпадающее со значением в основной таблице. Выберите **Организация**. Excel выполняет поиск всех рекомендуемых таблиц, к которым у вас есть доступ, и ищет совпадение.

:::image type="content" source="media/service-excel-featured-tables/excel-table-organization.png" alt-text="Снимок экрана: выбор ячейки или диапазона ячеек.":::
 
Если вы знаете, какая рекомендуемая таблица вам требуется, выберите в коллекции **Из вашей организации (предварительная версия)** и выберите требуемую таблицу.

:::image type="content" source="media/service-excel-featured-tables/excel-organizational-data-table.png" alt-text="Снимок экрана: Организационные данные в Excel, таблица типов данных Поставщики.":::
 
Если при поиске в Excel найдена совпадающая с высокой достоверностью строка, ячейка связывается непосредственно с этой строкой. Значок связанного элемента указывает на то, что ячейки связаны со строкой в Power BI.

:::image type="content" source="media/service-excel-featured-tables/excel-linked-card-icon.png" alt-text="Снимок экрана: значок связанного элемента.":::

Если ячейка содержит более одной потенциально совпадающей строки, в ячейке отображается значок вопросительного знака, и отображается область **Выбор данных**. В следующем примере пользователь выбрал диапазон "B2: B10" и выполнял поиск рекомендованной таблицы Power BI. Все строки соответствуют, за исключением ячейки B5, "Ma Maison". В области **Выбор данных** показаны два возможных совпадения.

:::image type="content" source="media/service-excel-featured-tables/excel-data-selector-pane.png" alt-text="Снимок экрана: панель выбора данных Excel.":::
 
Параметр "Организационные данные" может возвращать строки из нескольких рекомендуемых таблиц. Excel группирует потенциально совпадающие строки по типу данных, к которому они относятся. Excel сортирует типы данных по достоверности совпадения строки. Чтобы свернуть и развернуть типы данных с совпадающими строками, используйте угловые стрелки.

:::image type="content" source="media/service-excel-featured-tables/excel-data-selector-multiple.png" alt-text="Снимок экрана: область выбора данных Excel с несколькими возможностями.":::
 
Выберите имя каждой строки, чтобы просмотреть дополнительные сведения, которые помогут выбрать нужную. Найдя строку, нажмите **Выбрать**, чтобы связать ее с ячейкой в Excel. 

:::image type="content" source="media/service-excel-featured-tables/excel-data-selector-details.png" alt-text="Снимок экрана: сведения в области выбора данных.":::
 
При выборе значка **Карточка** в ячейке отображается карточка с данными из всевозможных полей и вычисляемых полей в рекомендуемой таблице. В заголовке карточки указывается значение поля метки строки в рекомендуемой таблице.
 
:::image type="content" source="media/service-excel-featured-tables/excel-linked-item-details.png" alt-text="Снимок экрана: сведения о связанном элементе.":::

Щелкните значок **Вставить данные**, а затем выберите имя поля из списка полей, чтобы добавить его значение в сетку.  

:::image type="content" source="media/service-excel-featured-tables/excel-select-field.png" alt-text="Снимок экрана: выбор имени поля.":::

Значения или значения поля помещаются в смежные ячейки. Формула ячейки ссылается на связанную ячейку и имя поля, чтобы можно было использовать эти данные в функциях Excel.

:::image type="content" source="media/service-excel-featured-tables/excel-cell-formula.png" alt-text="Снимок экрана: формула ячейки Excel.":::

## <a name="cell-formulas"></a>Формулы ячеек

При использовании таблицы Excel можно ссылаться на связанный столбец таблицы, а затем добавлять поля данных, используя ссылку `.` (точку).

:::image type="content" source="media/service-excel-featured-tables/excel-dot-reference.png" alt-text="Снимок экрана: ссылка с использованием точки в Excel.":::

Аналогично, при использовании ячейки можно ссылаться на ячейку и использовать ссылку `.` (точку) для получения полей.

:::image type="content" source="media/service-excel-featured-tables/excel-cell-dot-reference.png" alt-text="Снимок экрана: ссылка с использованием точки.":::
 
## <a name="data-caching-and-refresh"></a>Кэширование и обновление данных

Когда программа Excel связывает ячейку со строкой в рекомендуемой таблице Power BI, она извлекает и сохраняет все значения полей в файле Excel. Любой пользователь, которому вы предоставляете общий доступ к файлу, может ссылаться на любое поле, не запрашивая данные у Power BI.  

Используйте на ленте вкладки **Данные** кнопку **Обновить все**, чтобы обновить данные в связанных ячейках. 

:::image type="content" source="media/service-excel-featured-tables/excel-refresh-all.png" alt-text="Снимок экрана: кнопка Обновить все.":::
 
Можно также обновить отдельные ячейки. Щелкните правой кнопкой мыши ячейку и выберите **Типы данных** > **Обновить**.

## <a name="show-a-card-change-or-convert-to-text"></a>Отображение карточки, изменение и преобразование в текст

Для связанных ячеек в контекстное меню добавлены дополнительные параметры. Щелкните ячейку правой кнопкой мыши. Наряду с обычными параметрами вы также видите следующее:

- **Показать карточку для типа данных**.
- **Обновление**.
- **Изменить**.
- **Преобразовать в текст**

:::image type="content" source="media/service-excel-featured-tables/excel-right-click-data-type.png" alt-text="Снимок экрана: контекстное меню, пункт Преобразовать в текст.":::
 
Команда **Преобразовать в текст** удаляет ссылку на строку в рекомендуемой таблице Power BI. Важно, что текст в ячейке будет значением метки строки для связанной ячейки. Если ячейка связана не с той строкой, в Excel выберите **Отменить**, чтобы восстановить начальные значения ячеек.

## <a name="licensing"></a>Лицензирование

Коллекция "Типы данных" Excel и подключенные функциональные возможности для рекомендуемых таблиц Power BI доступны только для клиентов с Excel E5 и G5. 

## <a name="security"></a>Безопасность

Вы будете видеть только рекомендуемые таблицы из наборов данных, для которых у вас есть разрешение в Power BI. При обновлении данных для получения строк необходимо иметь разрешение на доступ к набору данных в Power BI. Для этого требуется разрешение на сборку или запись в наборе данных. Excel кэширует данные, возвращаемые для всей строки. Любой пользователь, которому вы предоставили общий доступ к файлу Excel, может видеть данные всех полей во всех связанных ячейках.

Если к набору данных Power BI применяется безопасность на уровне строк или метка конфиденциальности Microsoft Information Protection, то рекомендуемые таблицы из этого набора данных не включаются в коллекцию "Типы данных" в Excel. Это ограничение исходной предварительной версии.

## <a name="administrative-control"></a>Администрирование

Администраторы Power BI могут контролировать использование рекомендуемых таблиц в коллекции "Типы данных" Excel пользователями организации. Дополнительные сведения см. в разделе [Параметры рекомендуемых таблиц](../admin/service-admin-portal.md#featured-tables-settings) на портале администрирования. 
 
### <a name="auditing"></a>Аудит

В журналах аудита администрирования отображаются следующие события для рекомендуемых таблиц:

- **AnalyzedByExternalApplication**. Дает администраторам возможность видеть, какие пользователи обращаются к тем или иным рекомендуемым таблицам.
- **UpdateFeaturedTables**. Дает администраторам возможность видеть, какие пользователи публикуют и обновляют избранные таблицы.

Полный список событий журнала аудита см. в разделе [Отслеживание действий пользователей в Power BI](../admin/service-admin-auditing.md).

## <a name="considerations-and-limitations"></a>Рекомендации и ограничения

Ниже приведены ограничения для первоначальной предварительной версии.

- Интеграция доступна в сборках для участников программы предварительной оценки Excel.
- Коллекция "Типы данных" в Excel включает в себя рекомендуемые таблицы для пользователей с соответствующей лицензией в Power BI Desktop и службе Power BI. Поддержка службы Power BI может быть недоступна на этапе предварительной версии, но она будет добавлена.
- В Excel не отображаются рекомендуемые таблицы из наборов данных Power BI, которые используют следующие возможности: 

    - безопасность на уровне строк;
    - Microsoft Information Protection;
    - DirectQuery;
    - активное подключение.

- В Excel отображаются только данные в столбцах и вычисляемых столбцах рекомендуемой таблицы. В первоначальной предварительной версии не предоставляются следующие данные:

    - меры, определенные в рекомендуемой таблице;
    - меры, определенные в связанных таблицах, и неявные меры, вычисленные на основе связей.

- В Excel отображаются только рекомендуемые таблицы (*типы данных*), которые хранятся в новых рабочих областях Power BI. Рекомендуемые таблицы, хранящиеся в классических рабочих областях или в области "Моя рабочая область", не отображаются в Excel в виде типов данных. Вы можете [обновить классические рабочие области до новой версии](service-upgrade-workspaces.md) в Power BI.

Возможность "Типы данных" в Excel похожа на функцию поиска. Она принимает значение ячейки, предоставленное листом Excel, и ищет совпадающие строки в рекомендуемых таблицах Power BI. Функция поиска работает следующим образом.

- При использовании для поиска кнопки **Организационные данные** Excel выполняет поиск только среди рекомендуемых таблиц в сертифицированных наборах данных.
- Сопоставление строк выполняется по текстовым столбцам в рекомендуемой таблице. Для него используется та же индексация, что и для возможности "Вопросы и ответы" в Power BI, которая оптимизирована для поиска на английском языке. Поиск на других языках может не дать точного совпадения. Числовые столбцы не учитываются при сопоставлении.
- Сопоставление основано на точных и префиксных совпадениях для отдельных условий поиска. Значение ячейки разделяется по пробелам или другим символам разделения, например по табуляциям. Затем каждое слово считается условием поиска. Значения текстовых полей строки сравниваются с каждым таким условием на предмет точных и префиксных совпадений. Префиксное совпадение возвращается, если текстовое поле строки начинается с условия поиска. Например, если ячейка содержит текст "Orange County", то "Orange" и "County" — это уникальные условия поиска. 

    - Возвращаются строки с текстовыми столбцами, значение которых точно совпадает с "Orange" или "County". 
    - Возвращаются строки с текстовым столбцом, значение которого начинается со слов "Orange" или "County". 
    - Важно, что строки, содержащие "Orange" или "County", но не начинающиеся с них, не возвращаются.

- Power BI возвращает не более 100 предлагаемых строк для каждой ячейки.
- Установка и обновление рекомендуемой таблицы не поддерживается в конечной точке XMLA.
- Для публикации рекомендуемых таблиц можно использовать файлы Excel с моделью данных. Загрузите данные в Power BI Desktop, а затем опубликуйте рекомендуемую таблицу.
- Изменение имени таблицы, метки строки или ключевого столбца в рекомендованной таблице может повлиять на пользователей Excel, в таблицах которых содержатся ячейки со связанными строками. 
- Excel уведомляет о времени и дате извлечения данных из набора данных Power BI. Это не обязательно будет время обновления данных в Power BI или время создания последней точки данных в наборе данных. Предположим, например, что набор данных в Power BI был обновлен неделю назад, но на тот момент базовые исходные данные существовали уже неделю. Фактический срок существования данных — 2 недели, но в Excel будут показаны дата и время извлечения данных в Excel.

## <a name="next-steps"></a>Дальнейшие действия

- [Настройка рекомендуемых таблиц в Power BI Desktop](service-create-excel-featured-tables.md)
- Сведения об использовании [типов данных Excel из Power BI](https://support.office.com/article/use-excel-data-types-from-power-bi-preview-cd8938ce-f963-444d-b82a-7140848241e9) приведены в документации по Excel.
- У вас появились вопросы? [Ответы на них см. в сообществе Power BI.](https://community.powerbi.com/)

