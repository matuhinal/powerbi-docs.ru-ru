---
title: Доступ к рекомендуемым таблицам Power BI в Excel (предварительная версия)
description: В Excel можно использовать данные из рекомендуемых таблиц в наборах данных Power BI в коллекции "Типы данных".
author: maggiesMSFT
ms.reviewer: lukaszp
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: how-to
ms.date: 05/20/2020
ms.author: maggies
LocalizationGroup: Share your work
ms.openlocfilehash: a872c0ada80a7168ebc6bb545de1ad474c4561b7
ms.sourcegitcommit: eef4eee24695570ae3186b4d8d99660df16bf54c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2020
ms.locfileid: "85226355"
---
# <a name="access-power-bi-featured-tables-in-excel-preview"></a>Доступ к рекомендуемым таблицам Power BI в Excel (предварительная версия)

В Excel можно использовать данные из рекомендуемых таблиц в наборах данных Power BI в коллекции "Типы данных". Рекомендуемые таблицы упрощают добавление корпоративных данных на листы Excel. Используя сертифицированные и более информативные возможности наборов данных Power BI, организации предоставляют большему числу пользователей возможность находить и использовать актуальные и обновляемые данные для принятия оптимальных решений. Дополнительные сведения об использовании [типов данных Excel из Power BI](https://support.office.com/article/use-excel-data-types-from-power-bi-preview-cd8938ce-f963-444d-b82a-7140848241e9) приведены в документации по Excel.

В коллекции "Типы данных" отображаются только те рекомендуемые таблицы, добавление которых в наборы данных Power BI курировал администратор моделей. Вы можете также просмотреть в Excel любой набор данных, доступный вам в Power BI. В Excel на ленте вкладки **Данные** в разделе **Получение данных** выберите **Наборы данных Power BI**.

## <a name="access-power-bi-data-through-the-excel-data-types-gallery"></a>Доступ к данным Power BI с помощью коллекции "Типы данных" в Excel
Рекомендуемые таблицы в наборах данных Power BI отображаются в Excel на вкладке "Данные" в коллекции "Типы данных".

:::image type="content" source="media/service-excel-featured-tables/excel-data-ribbon.png" alt-text="Лента вкладки "Данные" в Excel":::

При развертывании в коллекции отображаются первые доступные типы данных.

:::image type="content" source="media/service-excel-featured-tables/excel-data-types-gallery.png" alt-text="Коллекция "Типы данных" в Excel":::
 
Для поиска данных в рекомендуемой таблице Power BI выберите ячейку или диапазон на листе Excel.

:::image type="content" source="media/service-excel-featured-tables/excel-select-cell.png" alt-text="Выбор ячейки":::
 
В коллекции выберите параметр **Организационные данные**, чтобы найти данные в рекомендуемых таблицах в доступных вам сертифицированных наборах данных.

:::image type="content" source="media/service-excel-featured-tables/excel-organizational-data.png" alt-text="Получение организационных данных":::
 
Выберите конкретный тип данных, если вы знаете какого рода данные вам нужны. В противном случае вы не найдете соответствующие вашему запросу строки с помощью параметра "Организационные данные".

:::image type="content" source="media/service-excel-featured-tables/excel-select-data-type.png" alt-text="Выбор типа данных":::
 
Если при поиске найдена совпадающая с высокой достоверностью строка, ячейка связывается непосредственно с этой строкой. Значок связанного элемента указывает на то, что ячейка связана со строкой в Power BI.

:::image type="content" source="media/service-excel-featured-tables/excel-linked-item-icon.png" alt-text="Значок связанного элемента":::

Если для ячейки обнаружено несколько возможных совпадающих строк, отображается область выбора данных. В ячейке отображается значок вопросительного знака, с помощью которого можно открыть область выбора данных для такой строки. В приведенном ниже примере пользователь выбрал диапазон A2:A7 и выполнил поиск в рекомендуемой таблице Power BI.

:::image type="content" source="media/service-excel-featured-tables/excel-multiple-matches.png" alt-text="Несколько возможных совпадающих строк":::

В области **Выбор данных** отображаются потенциально совпадающие строки.

:::image type="content" source="media/service-excel-featured-tables/excel-data-selector-pane.png" alt-text="Область "Выбор данных" в Excel":::
 
Параметр "Организационные данные" может возвращать строки нескольких типов данных. Excel группирует потенциально совпадающие строки по типу данных, к которому они относятся. Excel сортирует типы данных по достоверности совпадения строки. Чтобы свернуть и развернуть типы данных с совпадающими строками, используйте угловые стрелки.

:::image type="content" source="media/service-excel-featured-tables/excel-data-selector-multiple.png" alt-text="Область "Выбор данных" в Excel":::
 
Выберите имя каждой строки, чтобы просмотреть дополнительные сведения, которые помогут выбрать нужную. Найдя строку, нажмите **Выбрать**, чтобы связать ее с ячейкой в Excel. 

:::image type="content" source="media/service-excel-featured-tables/excel-data-selector-select.png" alt-text="Сведения в области "Выбор данных"":::
 
При выборе строки ячейка связывается со строкой, а ее значение — со значением поля **Метка строки** в рекомендуемой таблице Power BI. 

:::image type="content" source="media/service-excel-featured-tables/excel-linked-item-icon.png" alt-text="Связанный элемент в Excel":::
 
При выборе значка **Связанная ячейка** отображается карточка с данными из всевозможных полей и вычисляемых полей в рекомендуемой таблице. В заголовке карточки указывается значение поля метки строки в рекомендуемой таблице.
 
:::image type="content" source="media/service-excel-featured-tables/excel-linked-item-details.png" alt-text="Сведения о связанном элементе":::

Щелкните значок **Вставить данные**, чтобы добавить значения полей в сетку.

:::image type="content" source="media/service-excel-featured-tables/excel-insert-data.png" alt-text="Вставка данных"::: 

Выберите имя поля из списка полей, чтобы добавить его значение в сетку.  

:::image type="content" source="media/service-excel-featured-tables/excel-select-field.png" alt-text="Выберите имя поля":::

Значение поля помещается в смежную ячейку. Формула ячейки ссылается на связанную ячейку и имя поля, чтобы можно было использовать эти данные в функциях Excel.

:::image type="content" source="media/service-excel-featured-tables/excel-cell-formula.png" alt-text="Формула в ячейке Excel":::
 
При форматировании данных в виде таблицы Excel добавление полей расширяет ее и задает заголовок столбца в соответствии с именем поля. Строки, связанные с теми же типами данных, также заполняются соответствующими значениями.

:::image type="content" source="media/service-excel-featured-tables/excel-field-column-name.png" alt-text="Поле является именем столбца"::: 

## <a name="cell-formulas"></a>Формулы ячеек

При использовании таблицы Excel можно ссылаться на связанный столбец таблицы, а затем добавлять поля данных, используя ссылку `.` (точку).

:::image type="content" source="media/service-excel-featured-tables/excel-dot-reference.png" alt-text="Ссылка с использованием точки в Excel":::

Аналогично, при использовании ячейки можно ссылаться на ячейку и использовать ссылку `.` (точку) для получения полей.

:::image type="content" source="media/service-excel-featured-tables/excel-cell-dot-reference.png" alt-text="Ссылка на ячейку с использованием точки":::
 
## <a name="data-caching-and-refresh"></a>Кэширование и обновление данных

Когда программа Excel связывает ячейку со строкой в рекомендуемой таблице Power BI, она извлекает и сохраняет все значения полей в файле Excel. Любой пользователь, которому вы предоставляете общий доступ к файлу, может ссылаться на любое поле, не запрашивая данные у Power BI.  

Используйте на ленте вкладки **Данные** кнопку **Обновить все**, чтобы обновить данные в связанных ячейках. 

:::image type="content" source="media/service-excel-featured-tables/excel-refresh-all.png" alt-text="Обновить все":::
 
Можно также обновить отдельные ячейки. Щелкните правой кнопкой мыши ячейку и выберите **Типы данных** > **Обновить**.

## <a name="show-a-card-change-or-convert-to-text"></a>Отображение карточки, изменение и преобразование в текст

Для связанных ячеек в контекстное меню добавлены дополнительные параметры. Щелкните ячейку правой кнопкой мыши и выберите **Тип данных** >  

- **Показать карточку**
- **Обновление**
- **Изменение** 
- **Преобразовать в текст**

:::image type="content" source="media/service-excel-featured-tables/excel-right-click-data-type.png" alt-text="Пункт "Преобразовать в текст" в контекстном меню":::
 
Команда **Преобразовать в текст** удаляет ссылку на строку в рекомендуемой таблице Power BI. Важно, что текст в ячейке будет значением метки строки для связанной ячейки. Если ячейка связана не с той строкой, в Excel выберите **Отменить**, чтобы восстановить начальные значения ячеек.

## <a name="licensing"></a>Лицензирование
Коллекция "Типы данных" Excel и подключенные функциональные возможности для рекомендуемых таблиц Power BI доступны только для клиентов с Excel E5 и G5. 

## <a name="security"></a>Безопасность

Вы будете видеть только рекомендуемые таблицы из наборов данных, для которых у вас есть разрешение в Power BI. При обновлении данных для получения строк необходимо иметь разрешение на доступ к набору данных в Power BI. Для этого требуется разрешение на сборку или запись в наборе данных. Excel кэширует данные, возвращаемые для всей строки. Любой пользователь, которому вы предоставили общий доступ к файлу Excel, может видеть данные всех полей во всех связанных ячейках.

Если к набору данных Power BI применяется безопасность на уровне строк или метка конфиденциальности Microsoft Information Protection, то рекомендуемые таблицы из этого набора данных не включаются в коллекцию "Типы данных" в Excel. Это ограничение исходной предварительной версии.

## <a name="curate-a-featured-table-in-power-bi-desktop"></a>Курирование рекомендуемых таблиц в Power BI Desktop
В Excel в коллекции "Типы данных" отображаются рекомендуемые таблицы из наборов данных, отправленных в службу Power BI. Используйте Power BI Desktop для курирования рекомендуемых таблиц в модели данных и их отправки в службу Power BI.

### <a name="turn-on-the-featured-table-preview"></a>Включение предварительной версии рекомендуемых таблиц

1. В Power BI Desktop последовательно выберите **Файл** > **Параметры и настройки** > **Параметры** > **Функции на этапе предварительного просмотра**.
2. Установите флажок **Featured tables** (Рекомендуемые таблицы).

    :::image type="content" source="media/service-excel-featured-tables/power-bi-preview-featured-tables.png" alt-text="Параметр предварительной версии рекомендуемых таблиц":::

### <a name="select-a-table"></a>Выбор таблицы

1. В Power BI Desktop перейдите в представление модели.

    :::image type="content" source="media/service-excel-featured-tables/power-bi-model-view.png" alt-text="Представление модели":::
 
2. Выберите таблицу и задайте для параметра **Is featured table** (Рекомендуемая таблица) значение **Да**.

    :::image type="content" source="media/service-excel-featured-tables/power-bi-featured-table-yes.png" alt-text="Для параметра Is featured table (Рекомендуемая таблица) задано значение "Да"":::

4. В окне **Set up this featured table** (Настройка этой рекомендуемой таблицы) заполните обязательные поля:

    - **Описание**.
    - Значение поля **Метка строки** используется в Excel, чтобы пользователи могли легко опознать эту строку. Он отображается как значение связанной ячейки, в области **Выбор данных** и на карточке **Информация**. 
    - Значение поля **Ключевой столбец** содержит уникальный идентификатор строки. Это значение позволяет Excel связать ячейку с определенной строкой в таблице.

    :::image type="content" source="media/service-excel-featured-tables/power-bi-set-up-featured-table.png" alt-text="Настройка рекомендуемой таблицы":::

После публикации или импорта набора данных в службе Power BI рекомендуемая таблица отображается в Excel в коллекции "Типы данных".

- Excel кэширует список типов данных, поэтому, чтобы увидеть только что опубликованные рекомендуемые таблицы, необходимо перезапустить Excel.
- Некоторые наборы данных не поддерживаются в предварительной версии, поэтому рекомендуемые таблицы, определенные в этих наборах данных, не будут отображаться в Excel. Дополнительные сведения см. в разделе рекомендаций и ограничений.

## <a name="administrative-control"></a>Администрирование

Администраторы Power BI могут контролировать использование рекомендуемых таблиц в коллекции "Типы данных" Excel пользователями организации. Дополнительные сведения см. в разделе [Параметры рекомендуемых таблиц](../admin/service-admin-portal.md#featured-tables-settings) на портале администрирования. 
 
### <a name="auditing"></a>Аудит

В журналах аудита администрирования отображаются следующие события для рекомендуемых таблиц:

- **AnalyzedByExternalApplication**. Дает администраторам возможность видеть, какие пользователи обращаются к тем или иным рекомендуемым таблицам.
- **UpdateFeaturedTables**. Дает администраторам возможность видеть, какие пользователи публикуют и обновляют избранные таблицы.

Полный список событий журнала аудита см. в разделе [Отслеживание действий пользователей в Power BI](../admin/service-admin-auditing.md).

## <a name="considerations-and-limitations"></a>Рекомендации и ограничения

Ниже приведены ограничения для первоначальной предварительной версии.

- Интеграция доступна в сборках для участников программы предварительной оценки Excel.
- Коллекция "Типы данных" в Excel включает в себя рекомендуемые таблицы для пользователей с соответствующей лицензией в Power BI Desktop и службе Power BI. Поддержка службы Power BI может быть недоступна на этапе предварительной версии, но она будет добавлена.
- В Excel не отображаются рекомендуемые таблицы из наборов данных Power BI, которые используют следующие возможности: 

    - безопасность на уровне строк;
    - Microsoft Information Protection;
    - DirectQuery;
    - активное подключение.

- В Excel отображаются только данные в столбцах и вычисляемых столбцах рекомендуемой таблицы. В первоначальной предварительной версии не предоставляются следующие данные:

    - меры, определенные в рекомендуемой таблице;
    - меры, определенные в связанных таблицах, и неявные меры, вычисленные на основе связей.

- В Excel отображаются только рекомендуемые таблицы, которые хранятся в новых рабочих областях Power BI. Рекомендуемые таблицы, хранящиеся в классических рабочих областях или в области "Моя рабочая область", не отображаются в Excel в виде типов данных. Вы можете [обновить классические рабочие области до новой версии](service-upgrade-workspaces.md) в Power BI.

Возможность "Типы данных" в Excel похожа на функцию поиска. Она принимает значение ячейки, предоставленное листом Excel, и ищет совпадающие строки в рекомендуемых таблицах Power BI. Функция поиска работает следующим образом.

- При использовании для поиска кнопки **Организационные данные** Excel выполняет поиск только среди рекомендуемых таблиц в сертифицированных наборах данных.
- Сопоставление строк выполняется по текстовым столбцам в рекомендуемой таблице. Для него используется та же индексация, что и для возможности "Вопросы и ответы" в Power BI, которая оптимизирована для поиска на английском языке. Поиск на других языках может не дать точного совпадения. Числовые столбцы не учитываются при сопоставлении.
- Сопоставление основано на точных и префиксных совпадениях для отдельных условий поиска. Значение ячейки разделяется по пробелам или другим символам разделения, например по табуляциям. Затем каждое слово считается условием поиска. Значения текстовых полей строки сравниваются с каждым таким условием на предмет точных и префиксных совпадений. Префиксное совпадение возвращается, если текстовое поле строки начинается с условия поиска. Например, если ячейка содержит текст "Orange County", то "Orange" и "County" — это уникальные условия поиска. 

    - Возвращаются строки с текстовыми столбцами, значение которых точно совпадает с "Orange" или "County". 
    - Возвращаются строки с текстовым столбцом, значение которого начинается со слов "Orange" или "County". 
    - Важно, что строки, содержащие "Orange" или "County", но не начинающиеся с них, не возвращаются.

- Power BI возвращает не более 100 предлагаемых строк для каждой ячейки.
- Установка и обновление рекомендуемой таблицы не поддерживается в конечной точке XMLA.
- Для публикации рекомендуемых таблиц можно использовать файлы Excel с моделью данных. Загрузите данные в Power BI Desktop, а затем опубликуйте рекомендуемую таблицу.
- Изменение имени таблицы, метки строки или ключевого столбца в рекомендованной таблице может повлиять на пользователей Excel, в таблицах которых содержатся ячейки со связанными строками. 
- Excel уведомляет о времени и дате извлечения данных из набора данных Power BI. Это не обязательно будет время обновления данных в Power BI или время создания последней точки данных в наборе данных. Предположим, например, что набор данных в Power BI был обновлен неделю назад, но на тот момент базовые исходные данные существовали уже неделю. Фактический срок существования данных — 2 недели, но в Excel будут показаны дата и время извлечения данных в Excel.

## <a name="next-steps"></a>Дальнейшие действия

- У вас появились вопросы? [Ответы на них см. в сообществе Power BI.](https://community.powerbi.com/)

