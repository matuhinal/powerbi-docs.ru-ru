---
title: Рекомендации по оптимизации Power BI
description: Рекомендации по оптимизации для Power BI.
author: peter-myers
ms.reviewer: asaxton
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 02/16/2020
ms.author: v-pemyer
ms.openlocfilehash: d718c9c7f627d735c083a46c1483815e3744faca
ms.sourcegitcommit: 7aa0136f93f88516f97ddd8031ccac5d07863b92
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/05/2020
ms.locfileid: "79378876"
---
# <a name="optimization-guide-for-power-bi"></a>Рекомендации по оптимизации Power BI

В этой статье приводятся рекомендации, которые помогут разработчикам и администраторам создавать и поддерживать оптимизированные решения Power BI. Вы можете оптимизировать решение на разных уровнях архитектуры. В том числе:

- источники данных;
- модель данных;
- визуализации, включая панели мониторинга, отчеты Power BI и отчеты Power BI с разбивкой на страницы;
- параметры среды, например емкость, шлюзы данных и сеть.

## <a name="optimizing-the-data-model"></a>Оптимизация модели данных

Модель данных поддерживает возможность полной визуализации. Модели данных можно размещать как внутри, так и снаружи системы. В Power BI они называются _наборами данных_. Важно понимать доступные варианты и правильно выбрать тип набора данных для конкретного решения. Существуют три режима для наборов данных: режим импорта, режим DirectQuery и составной режим. Дополнительные сведения см. в статьях [Наборы данных в службе Power BI](../service-datasets-understand.md) и [Режимы наборов данных в службе Power BI](../service-dataset-modes-understand.md).

Рекомендации по конкретным режимам набора данных см. в следующих статьях:

- [Методы уменьшения объема данных для моделирования импорта](import-modeling-data-reduction.md)
- [Руководство по использованию модели DirectQuery в Power BI Desktop](directquery-model-guidance.md)
- [Рекомендации по разработке составной модели в Power BI Desktop](composite-model-guidance.md)

## <a name="optimizing-visualizations"></a>Оптимизация визуализаций

К визуализациям в Power BI относятся панели мониторинга, отчеты Power BI и отчеты Power BI с разбивкой на страницы. Каждый тип имеет свою архитектуру, и рекомендации тоже будут разными. 

### <a name="dashboards"></a>Панели мониторинга

Важно понимать, что Power BI поддерживает кэш для плиток панели мониторинга, за исключением активных плиток отчетов и плиток потоковой передачи. Дополнительные сведения см. раздел "Обновление плитки" в статье [Обновление данных в Power BI](../refresh-data.md#tile-refresh). Если набор данных применяет динамический [механизм безопасности на уровне строк (RLS)](../service-admin-rls.md), тщательно оцените влияние этого механизма на производительность, так как плитки будут кэшироваться отдельно для каждого пользователя.

Плитки динамических отчетов, закрепленные на панели мониторинга, не используют кэш запросов. Они функционируют так же, как и отчеты, и отправляют запросы в ядро сервера в режиме реального времени.

Как понятно из названия, получение данных из кэша позволяет повысить и стабилизировать производительность по сравнению с прямыми обращениями к источнику данных. Один из способов воспользоваться преимуществами этой возможности — отображать панели мониторинга в качестве первой целевой страницы для пользователей. Закрепите часто используемые и запрашиваемые визуальные элементы на панели мониторинга. Таким образом, панели мониторинга становятся важной "первой линией защиты", что обеспечивает согласованную производительность с меньшей нагрузкой на ресурсы. Пользователи по-прежнему могут переходить к отчетам для анализа подробных сведений.

Для наборов данных DirectQuery и с активным подключением кэш запроса периодически обновляется по запросам к источнику данных. По умолчанию это происходит каждый час, но вы можете настроить это значение в параметрах набора данных. При каждом обновлении кэша будут отправляться запросы к источнику данных. Количество созданных запросов зависит от количества визуальных элементов, закрепленных на панелях мониторинга, которые основаны на этом источнике данных. Обратите внимание: если включена безопасность на уровне строк, запросы создаются для каждого контекста безопасности. Предположим, что существуют две разные роли, которые присваиваются пользователям, с двумя разными представлениями данных. В этом случае при обновлении кэша запросов Power BI создает два набора запросов.

### <a name="power-bi-reports"></a>Отчеты Power BI

Есть несколько рекомендаций по оптимизации проектирования отчетов Power BI.

> [!NOTE]
> Если отчеты основаны на наборе данных DirectQuery, вы можете получить дополнительные рекомендации по проектированию отчетов в [руководстве по модели DirectQuery в Power BI Desktop, посвященном оптимизация моделей отчетов](directquery-model-guidance.md#optimize-report-designs).

#### <a name="apply-the-most-restrictive-filters"></a>Применение наиболее ограничительных фильтров

Чем больше данных нужно отобразить в визуальном элементе, тем медленнее он загружается. Хотя этот принцип кажется очевидным, о нем можно легко забыть. Например, у вас есть крупный набор данных. На основе этого набора данных вы создаете отчет с таблицей. Чтобы перейти к нужным строкам, пользователи применяют срезы на странице, обычно размером не более нескольких десятков строк.

Распространенная ошибка в такой ситуации — не использовать фильтрацию для представления таблицы по умолчанию, то есть отображать все 100 млн строк. Данные для этих строк загружаются в память и распаковываются при каждом обновлении. Такая обработка создает значительную нагрузку на память. Чтобы решить эту проблему, с помощью фильтра "Первые N" сократите максимальное количество элементов, которые отображаются в таблице. Максимальное количество элементов может быть значительно больше, чем может понадобиться пользователям, например 10 000. В результате этого качество взаимодействия с конечным пользователем не изменится, однако нагрузка на память значительно снизится. И, что более важно, повышается производительность.

Мы рекомендуем применять аналогичный подход ко всем визуальным элементам в отчетах. Задайте себе вопрос, все ли данные нужны в этом визуальном элементе. Можно ли отфильтровать количество данных, отображаемых в визуальном элементе, с минимальным влиянием на взаимодействие с пользователем? Не забывайте, что таблицы могут быть особенно ресурсоемкими.

#### <a name="limit-visuals-on-report-pages"></a>Ограничение визуальных элементов на страницах отчета

Описанный выше принцип распространяется и на количество визуальных элементов на странице отчета. Мы настоятельно рекомендуем отображать на каждой странице отчета только необходимое количество визуальных элементов. [Детализированные страницы](report-drillthrough.md) и [всплывающие подсказки на странице отчета](report-page-tooltips.md) дают отличные возможности для предоставления дополнительных сведений без большого количества визуальных элементов в отчете.

#### <a name="evaluate-custom-visual-performance"></a>Оценка производительности настраиваемых визуальных элементов

Обязательно проверьте настраиваемые визуальные элементы в работе, чтобы обеспечить высокую производительность. Плохо оптимизированные визуальные элементы Power BI могут отрицательно повлиять на производительность всего отчета.

### <a name="power-bi-paginated-reports"></a>Отчеты с разбивкой на страницы в Power BI

Макеты отчетов Power BI с разбивкой на страницы можно оптимизировать, применяя рекомендации по извлечению данных для отчета. Дополнительные сведения см. в [руководстве по получению данных для отчетов с разбивкой на страницы](report-paginated-data-retrieval.md).

Кроме того, предоставьте для [рабочей нагрузки страничных отчетов](../service-admin-premium-workloads.md#paginated-reports) достаточное количество памяти.

## <a name="optimizing-the-environment"></a>Оптимизация среды

Вы можете оптимизировать среду Power BI, настроив параметры емкости, ограничив размер шлюзов данных и уменьшив задержку в сети.

### <a name="capacity-settings"></a>Параметры емкости

При использовании выделенных мощностей, которые доступны для Power BI Premium (ценовые категории P) или Power BI Embedded (ценовые категории A4-A6), можно управлять параметрами емкости. Дополнительные сведения см. в статье [Управление емкостями Premium](../service-premium-capacity-manage.md). Рекомендации по оптимизации производительности для емкости Premium см. в [этой статье](../service-premium-capacity-optimize.md).

### <a name="gateway-sizing"></a>Выбор размера шлюза

Шлюз используется каждый раз, когда Power BI требуется доступ к данным, которые недоступны непосредственно через Интернет. Вы можете установить [локальный шлюз данных](../service-gateway-onprem.md) на локальном сервере или в инфраструктуре IaaS на виртуальной машине.

Сведения о рабочих нагрузках локального шлюза данных и рекомендации по выбору размера см. в [этой статье](gateway-onprem-sizing.md).

### <a name="network-latency"></a>Задержка в сети

Задержка в сети может повлиять на производительность отчета, увеличив время, необходимое для передачи запросов в службу Power BI и для доставки ответов. Каждый клиент в Power BI назначается в определенный регион.

> [!TIP]
> Сведения об определении расположения клиента см. в [этой статье](../service-admin-where-is-my-tenant-located.md).

Если пользователи получают доступ к службе Power BI из клиента, их запросы всегда перенаправляется в этот регион. Когда запросы попадают в службу Power BI, эта служба может отправить дополнительные запросы, например, к основному источнику данных или шлюзу, и задержка в сети влияет на все эти запросы.

Такие инструменты, как [Azure Speed Test](https://azurespeedtest.azurewebsites.net/), могут определить задержку в сети между клиентом и регионом Azure. В большинстве случаев, чтобы свести к минимуму влияние задержки в сети, старайтесь размещать источники данных, шлюзы и кластер Power BI как можно ближе друг к другу. Желательно размещать их внутри одного региона. Если задержка в сети представляет проблему, вы можете попробовать расположить шлюзы и источники данных ближе к кластеру Power BI, разместив их на виртуальных машинах в облаке.

## <a name="monitoring-performance"></a>Мониторинг производительности

Вы можете отслеживать производительность для выявления проблем. Медленно работающие запросы или визуальные элементы отчета должны подвергаться непрерывной оптимизации. Мониторинг можно выполнять в Power BI Desktop во время разработки или на оборудовании Power BI Premium для производственных рабочих нагрузок. Дополнительные сведения см. в статье [Мониторинг производительности отчетов в Power BI](monitor-report-performance.md).

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения по этим вопросам см. в следующих ресурсах.

- [Руководство по Power BI](index.yml)
- [Мониторинг производительности отчетов в Power BI](monitor-report-performance.md)
- Технический документ. [Planning a Power BI Enterprise Deployment](https://go.microsoft.com/fwlink/?linkid=2057861) (Планирование развертывания Power BI Enterprise)
- У вас появились вопросы? [Попробуйте задать вопрос в сообществе Power BI.](https://community.powerbi.com/)
- У вас есть предложения? [Идеи по улучшению Power BI](https://ideas.powerbi.com/)
