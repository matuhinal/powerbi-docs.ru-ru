---
title: Технический документ по обеспечению безопасности в Power BI
description: В этом техническом документе описывается и рассматривается архитектура и реализация системы безопасности для Power BI
author: davidiseminger
ms.author: davidi
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 05/14/2020
LocalizationGroup: Conceptual
ms.openlocfilehash: 432f8a7a39e6902c679c83d447039519f90d0dac
ms.sourcegitcommit: be424c5b9659c96fc40bfbfbf04332b739063f9c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2020
ms.locfileid: "91635707"
---
# <a name="power-bi-security-whitepaper"></a>Технический документ по обеспечению безопасности в Power BI

**Сводка:** Power BI — это интерактивная программная служба (*SaaS*или программное обеспечение как услуга) от корпорации Майкрософт, которая позволяет легко и быстро создавать панели мониторинга, отчеты, наборы данных и визуализации для самостоятельной бизнес-аналитики. С помощью Power BI можно подключиться к множеству разных источников данных, комбинировать и формировать данные из этих подключений, а также создавать отчеты и панели мониторинга, которые можно использовать совместно с другими пользователями.

**Модуль записи:** Дэвид Глазков

**Технические рецензенты:** Педрам Резаеи, Кристиан Петкулеску, Сива Harinath, Тод Manning, Хайдн Ричардсон (, Адам Уилсон (, Бен Child, Роберт Бракнер, Сергеем Гундоров, Каспер de Jonge)

**Применимо к:** Power BI SaaS, Power BI Desktop, Power BI Embedded, Power BI Premium

> [!NOTE]
> Вы можете сохранить или распечатать этот технический документ, выбрав **Печать** в браузере, а затем выбрав **Сохранить как PDF**.

## <a name="introduction"></a>Введение

**Power BI** — это интерактивная программная служба (_SaaS_или программное обеспечение как услуга) от корпорации Майкрософт, которая позволяет легко и быстро создавать панели мониторинга, отчеты, наборы данных и визуализации для самостоятельной бизнес-аналитики. С помощью Power BI можно подключиться к множеству разных источников данных, комбинировать и формировать данные из этих подключений, а также создавать отчеты и панели мониторинга, которые можно использовать совместно с другими пользователями.

Работа службы Power BI регулируется [условиями использования Microsoft Online Services](https://www.microsoftvolumelicensing.com/DocumentSearch.aspx?Mode=3&amp;DocumentTypeId=31) и [корпоративным заявлением о конфиденциальности Майкрософт](https://www.microsoft.com/privacystatement/OnlineServices/Default.aspx). Расположение обработки данных описано в условиях использования Microsoft Online Services. Основным источником сведений о соответствии для Power BI является [центр управления безопасностью Майкрософт](https://www.microsoft.com/trustcenter). Группа Power BI усердно работает, чтобы предложить клиентам последние инновации и повышение производительности. Power BI в настоящее время находится на уровне D платформы соответствия Microsoft 365. Дополнительные сведения о соответствии см. в [центре управления безопасностью Майкрософт](https://www.microsoft.com/trust-center/compliance/compliance-overview).

Эта статья посвящена безопасности Power BI и описывает архитектуру Power BI, способы проверки подлинности пользователей в Power BI и установки подключений к данным, а также принципы хранения и перемещения данных в службе Power BI. В последнем разделе приведены вопросы, связанные с безопасностью, и ответы на них.

## <a name="power-bi-architecture"></a>Архитектура Power BI

Служба **Power BI** работает на базе **Azure** — [платформы для облачных вычислений](https://azure.microsoft.com/overview/what-is-azure/) корпорации Майкрософт. Сейчас Power BI развертывается во многих центрах обработки данных по всему миру, и существует множество активных развертываний, которые предоставляются клиентам в регионах, обслуживаемых этими центрами обработки данных, и аналогичное число пассивных развертываний, которые выступают в качестве резервных для активных.

Каждое развертывание Power BI состоит из двух кластеров — внешнего веб-кластера(**WFE**) и **внутреннего** кластера. Два этих кластера показаны на следующем рисунке и являются основой для оставшейся части этой статьи. 

![Кластер WFE и внутренний кластер](media/whitepaper-powerbi-security/powerbi-security-whitepaper_01.png)

Power BI использует Azure Active Directory (**AAD**) для проверки подлинности учетных записей и управления ими. Power BI также использует **диспетчер трафика Azure (ATM)** для направления пользовательского трафика в ближайший центр обработки данных, ОПРЕДЕЛЯЕМЫЙ DNS-записью клиента, пытающегося подключиться, для процесса проверки подлинности и загрузки статического содержимого и файлов. Power BI использует географически ближайший WFE для эффективного распространения необходимого статического содержимого и файлов пользователям, за исключением Power BIных визуальных элементов, которые доставляются с помощью **сети доставки содержимого (CDN) Azure**.

### <a name="the-wfe-cluster"></a>Кластер WFE

Кластер **WFE** управляет первоначальным соединением и процессом проверки подлинности в службе Power BI, с помощью AAD, а также предоставляет маркеры для последующих клиентских подключений к службе Power BI.

![Кластер WFE](media/whitepaper-powerbi-security/powerbi-security-whitepaper_02.png)

Когда пользователи пытаются подключиться к службе Power BI, служба DNS клиента может взаимодействовать с **диспетчером трафика Azure**, чтобы найти ближайший центр обработки данных с развертыванием Power BI. Дополнительные сведения об этом процессе см. в разделе [Метод маршрутизации трафика производительности для диспетчера трафика Azure](/azure/traffic-manager/traffic-manager-routing-methods#performance-traffic-routing-method).

Ближайший к пользователю кластер WFE управляет процедурой входа и проверки подлинности (описано далее в этой статье) и после успешной проверки предоставляет пользователю токен AAD. Компонент ASP.NET в кластере WFE анализирует запрос, чтобы определить, к какой организации относится пользователь, а затем обращается к **глобальной службе** Power BI. Глобальная служба — это отдельная таблица Azure, общая для всех кластеров WFE и внутренних кластеров по всему миру, которая сопоставляет пользователей и организаций клиентов с центрами обработки данных, где находится соответствующий клиент Power BI. Кластер WFE указывает браузеру, в каком внутреннем кластере размещается клиент организации. После проверки подлинности пользователя клиент взаимодействует напрямую с внутренним кластером, не используя кластер WFE в качестве посредника для этих запросов.

### <a name="the-power-bi-back-end-cluster"></a>Внутренний кластер Power BI

**Внутренний** кластер обеспечивает взаимодействие прошедших проверку подлинности клиентов со службой Power BI. **Внутренний** кластер управляет визуализациями, пользовательскими панелями мониторинга, наборами данных, отчетами, хранением данных, подключениями к данным, обновлением данных и другими видами взаимодействия со службой Power BI.

![Внутренний кластер](media/whitepaper-powerbi-security/powerbi-security-whitepaper_03.png)

**Роль шлюза** служит шлюзом между запросами пользователей и службой Power BI. Пользователи не взаимодействуют напрямую ни с одной ролью, кроме роли шлюза.

**Важно.** Необходимо отметить, что _только_ роли управления API Azure (**APIM**) и шлюза (**GW**) доступны через общедоступный Интернет. Они обеспечивают проверку подлинности, авторизацию, защиту от DDoS, регулирование, балансировку нагрузки, маршрутизацию и другие функции.

Пунктирная линия на представленном выше изображении **внутреннего** кластера демонстрирует границу между единственными двумя ролями, доступными пользователям (слева от пунктирной линии), и ролями, доступными только для системы. Когда прошедший проверку пользователь подключается к службе Power BI, **роль шлюза** и **Управление API Azure** принимают и обрабатывают соединение и все поступающие от клиента запросы, после чего взаимодействуют от имени пользователя с остальной частью службы Power BI. Например, если клиент пытается открыть панель мониторинга, **роль шлюза** принимает этот запрос, а затем самостоятельно отправляет **роли презентации** запрос о получении данных, необходимых для отображения панели мониторинга в браузере.

![Роль шлюза](media/whitepaper-powerbi-security/powerbi-security-whitepaper_04.png)

### <a name="power-bi-premium"></a>Power BI Premium

**Power BI Premium** предоставляет выделенную подготовленную и секционированную рабочую область службы для подписчиков, которым нужны выделенные ресурсы для работы в Power BI. Когда клиент регистрируется для получения подписки Power BI Premium, емкость Premium создается с помощью **Azure Resource Manager**. Развертывание этой подписки назначает набор виртуальных машин, соизмеримый с уровнем подписки, в центре обработки данных, где размещается клиент Power BI (кроме сред с поддержкой нескольких регионов, как описано далее в этом документе), инициированный в виде развертывания **Azure Service Fabric**.

![Power BI Premium](media/whitepaper-powerbi-security/powerbi-security-whitepaper_05.png)

После создания весь обмен данными с кластером Premium маршрутизируется через внутренний кластер Power BI, где устанавливается подключение к выделенной подписке виртуальных машин **Power BI Premium** клиента.

### <a name="data-storage-architecture"></a>Архитектура хранилища данных

Для хранения данных и управления ими Power BI использует два основных репозитория: данные, передаваемые пользователями, обычно отправляются в хранилище **BLOB-объектов Azure**, а все метаданные и артефакты для самой системы хранятся в **Базе данных SQL Azure** под защитой брандмауэра.

![Хранилище данных](media/whitepaper-powerbi-security/powerbi-security-whitepaper_06.png)

Например, когда пользователь импортирует книгу Excel в службу Power BI, создается выполняющаяся в памяти табличная база данных Analysis Services, а данные сохраняются в памяти на период до одного часа (или пока в системе не возникнет нехватка памяти). Эти данные также отправляются в хранилище **BLOB-объектов Azure**.

Метаданные о подписке Power BI пользователя, такие как панели мониторинга, отчеты, последние источники данных, рабочие области, организационные сведения, сведения о клиенте и другие метаданные о системе, хранятся и обновляются в **Базе данных SQL Azure**. Все данные, хранящиеся в базе данных SQL Azure, полностью шифруются с помощью технологии [прозрачного шифрования данных SQL Azure](/azure/sql-database/transparent-data-encryption-azure-sql) (TDE). Все данные, находящиеся в хранилище BLOB-объектов Azure, также шифруются. Дополнительные сведения о процессе загрузки, хранения и перемещения данных см. в разделе **Хранение и перемещение данных**.

## <a name="tenant-creation"></a>Создание клиента

Клиент — это выделенный экземпляр службы Azure AD, который получает и владеет организацией при регистрации в облачной службе Майкрософт, такой как Azure, Microsoft Intune, Power BI или Microsoft 365. Каждый клиент Azure AD является отдельным и не связан с другими клиентами Azure AD.

Клиент содержит пользователей в организации и информацию о них, такую как пароли, данные профилей пользователей, разрешения и т. д. Кроме того, он содержит группы, приложения и другие данные, относящиеся к организации и ее системе безопасности. Дополнительные сведения см. в статье [что такое клиент Azure AD](/office365/enterprise/subscriptions-licenses-accounts-and-tenants-for-microsoft-cloud-offerings).

Power BI клиент создается в центре обработки данных, который считается ближайшим к стране (или региону) и сведениям о состоянии, предоставленным клиенту в Azure Active Directory, который был предоставлен при первоначальной подготовке Microsoft 365 или служба Power BI. Сейчас клиент Power BI не перемещается из этого расположения центра обработки данных.

### <a name="multiple-geographies-multi-geo"></a>Поддержка нескольких регионов (Multi-Geo)

Некоторым организациям, исходя из потребностей бизнеса, требуется, чтобы служба Power BI присутствовала в нескольких географических регионах. Например, предприятие может иметь Power BI клиент в США, но также может выполнять бизнес в других географических областях, например в Австралии, и требовать, чтобы определенные данные Power BI оставались в этом удаленном регионе в соответствии с местным законодательством. Начиная со второй половины 2018, Организации с домашним клиентом в одном географическом виде могут также подготавливать и получать доступ к Power BI ресурсам, расположенным в другом географическом регионе. Для удобства в настоящем документе эта функция называется **поддержкой нескольких регионов**.

Самая актуальная и основная статья для нескольких географических сведений — [Настройка поддержки нескольких географических регионов для Power BI Premium](../admin/service-admin-premium-multi-geo.md) статье. 

Существует несколько технических сведений, которые следует оценить в контексте местных законов и нормативов при работе в разных географических регионах. Ниже приведены эти сведения.

- Слой выполнения удаленного запроса размещается в области удаленной емкости, чтобы гарантировать, что модель данных, кэши и большая обработка данных остаются в удаленной области емкости. Существуют некоторые исключения, как описано в статье о [нескольких географических целях Power BI Premium](../admin/service-admin-premium-multi-geo.md) .
- Кэшированный текст запроса и соответствующий результат, хранящийся в удаленном регионе, останутся в этом регионе, но другие данные в передаче могут передаваться между несколькими географическими регионами.
- Файлы PBIX или XLSX, которые публикуются (передаются) в несколько географических ресурсов служба Power BI могут привести к временной хранению копии в хранилище BLOB-объектов Azure в регионе клиента Power BI. В таких обстоятельствах данные шифруются с помощью Azure Шифрование службы хранилища (SSE), а копирование планируется для сборки мусора сразу после завершения обработки содержимого файла и его перемещения в удаленную область. 
- При перемещении данных между регионами в многоуровневой среде экземпляр данных в исходном регионе будет удален в течение 7-30 дней. 

### <a name="datacenters-and-locales"></a>Центры обработки данных и языковые стандарты

Power BI предоставляется в определенных регионах в зависимости от того, в каких региональных центрах обработки данных развернуты кластеры Power BI. Корпорация Майкрософт планирует распространить свою инфраструктуру Power BI на дополнительные центры обработки данных.

Указанные ниже страницы содержат дополнительные сведения о центрах обработки данных Azure.

- [Регионы Azure](https://azure.microsoft.com/regions/) — сведения о глобальном присутствии и расположениях Azure
- [Службы Azure по регионам](https://azure.microsoft.com/regions/#services) — полный перечень служб Azure (как инфраструктуры, так и платформы), предоставляемых корпорацией Майкрософт в каждом регионе.

В настоящее время служба Power BI доступен в конкретных регионах, обслуживаемых центрами обработки данных, как описано в [центре управления безопасностью Майкрософт](https://www.microsoft.com/TrustCenter/CloudServices/business-application-platform/data-location). По следующей ссылке приведена карта центров обработки данных Power BI, где вы можете навести указатель на регион для просмотра расположенных там центров обработки данных:

* [Центры обработки данных Power BI](https://www.microsoft.com/TrustCenter/CloudServices/business-application-platform/data-location)

Корпорация Майкрософт также предоставляет центров обработки данных для национальных облаков. Дополнительные сведения о доступности служб Power BI для национальных облаков см. в разделе [Национальные облака Power BI](https://powerbi.microsoft.com/clouds/).

Дополнительные сведения о месте хранения и использовании данных см. в [центре управления безопасностью Майкрософт](https://www.microsoft.com/TrustCenter/Transparency/default.aspx#_You_know_where). Обязательства относительно расположения неактивных данных клиента указаны в **условиях обработки данных** из [условиях использования Microsoft Online Services](https://www.microsoftvolumelicensing.com/DocumentSearch.aspx?Mode=3&amp;DocumentTypeId=31).

## <a name="user-authentication"></a>проверка подлинности пользователей;

Проверка подлинности пользователей в службе Power BI состоит из ряда запросов, ответов и перенаправлений между браузером пользователя и службой Power BI или службами Azure, используемыми в Power BI. Эта процедура описывает процесс проверки подлинности пользователей в Power BI. Дополнительные сведения о параметрах моделей проверки подлинности пользователей организации (модели входа) см. в разделе [Выбор модели входа для Microsoft 365](https://blogs.office.com/2014/05/13/choosing-a-sign-in-model-for-office-365/).

### <a name="authentication-sequence"></a>Процедура проверки подлинности

Процедура проверки подлинности пользователей для службы Power BI проходит согласно описанным ниже шагам, проиллюстрированным на следующих изображениях.

1. Пользователь инициирует подключение к служба Power BI из браузера, вводя в адресной строке Power BI адрес (например, `https://app.powerbi.com` ) или выбирая _вход_ с Power BI целевой страницы ( https://powerbi.microsoft.com) . Подключение устанавливается с использованием протоколов TLS 1.2 и HTTPS, а все последующее взаимодействие между браузером и службой Power BI осуществляется с помощью HTTPS. Направляется запрос в **диспетчер трафика Azure**.

2. **Диспетчера трафика Azure** проверяет запись DNS пользователя, чтобы определить ближайший центр обработки данных, где развернута служба Power BI, и отправляет службе DNS ответ с IP-адресом кластера WFE, куда следует направить пользователя.

3. После этого кластер WFE перенаправляет пользователя на страницу входа Microsoft Online Services.

    ![Процедура проверки подлинности](media/whitepaper-powerbi-security/powerbi-security-whitepaper_08.png)

1. После прохождения проверки подлинности пользователь переходит со страницы входа в ранее определенный ближайший **кластер WFE** службы Power BI.

2. Браузер отправляет файл cookie, полученный при успешном входе в Microsoft Online Services, и **служба ASP.NET** проверяет его внутри **кластера WFE**.

3. Кластер WFE взаимодействует со службой **Azure Active Directory** (**AAD**) для проверки подлинности подписки службы Power BI пользователя и для получения маркера безопасности AAD. Когда AAD возвращает сведения об успешной проверке подлинности пользователя и маркер безопасности AAD, кластер WFE обращается к **глобальной службе Power BI******, которая ведет список клиентов и расположений их внутренних кластеров Power BI, и определяет, какой кластер службы Power BI содержит клиент пользователя. После этого кластер WFE направляет пользователя в кластер Power BI, где находится его клиент, и возвращает коллекцию элементов в браузер пользователя:

      - **Маркер безопасности AAD**
      - **Сведения о сеансе**
      - Веб-адрес **внутреннего** кластера, с которым может взаимодействовать пользователь

1. Затем браузер пользователя связывается с указанной Azure CDN, а для некоторых файлов — WFE, чтобы скачать коллекцию указанных общих файлов, необходимых для обеспечения взаимодействия браузера со службой Power BI. После этого, страница в браузере включает в себя токен AAD, сведения о сеансе, расположение соответствующего внутреннего кластера и коллекцию файлов, скачанных из Azure CDN и кластера WFE, за период сеанса браузера службы Power BI.

![Взаимодействие с Azure CDN](media/whitepaper-powerbi-security/powerbi-security-whitepaper_09.png)

После завершения этих операций браузер связывается с указанным внутренним кластером, и начинается взаимодействие пользователя со службой Power BI. С этого момента все вызовы к службе Power BI выполняются с использованием указанного внутреннего кластера и содержат токен AAD пользователя. Токен AAD имеет время ожидания в один час, и кластер WFE периодически продляет действие токена, если сеанс пользователя остается открытым, чтобы сохранить доступ.

## <a name="data-storage-and-movement"></a>Хранение и перемещение данных

В службе Power BI данные находятся в _неактивном состоянии_ (доступные пользователю Power BI данные, с которыми не выполняются никакие действия) либо в _состоянии обработки_ (например, выполняемые запросы, используемые подключения к данным и модели, данные и (или) модели, отправляемые в службу Power BI, и другие действия, которые пользователи или служба Power BI могут выполнить с данными, для которых осуществляется активный доступ или обновление). Данные, находящиеся в процессе обработки, называются _обрабатываемыми данными_. Неактивные данные в Power BI шифруются. Передаваемые данные, то есть отправляемые или получаемые службой Power BI, также шифруются.

Кроме того, служба Power BI по-разному управляет данными в зависимости от того, осуществляется ли доступ к ним с помощью **DirectQuery** или импорта. Поэтому существуют две категории пользовательских данных для Power BI: данные, к которому обращаются с помощью DirectQuery, и данные, к которым не обращаются с помощью DirectQuery.

**DirectQuery** — это запрос, для которого запрос пользователя Power BI был переведен с языка DAX корпорации Майкрософт, используемого в Power BI и других продуктах Майкрософт для создания запросов, на собственный язык источника данных (например, T-SQL и другие собственные языки баз данных). Данные, связанные с DirectQuery, хранятся только по ссылке, то есть исходные данные не хранятся в Power BI, когда DirectQuery неактивен (за исключением данных визуализации, используемых для отображения панелей мониторинга и отчетов, как описано в разделе _Обрабатываемые данные (перемещение данных)_ ниже). Вместо этого хранятся ссылки на данные DirectQuery, обеспечивающие доступ к этим данным при выполнении DirectQuery. DirectQuery содержит все сведения, необходимые для выполнения запроса, включая строку подключения и учетные данные, используемые для доступа к источникам данных, что позволяет DirectQuery подключаться к включенным источникам данных для автоматического обновления. При использовании DirectQuery сведения базовой модели данных встраиваются в DirectQuery.

Запрос, для набора данных импорта, состоит из коллекции запросов DAX, которые _не_ переводятся непосредственно на собственный язык базового источника данных. Запросы импорта не включают учетные данные для базовых данных, и базовые данные загружаются в службу Power BI, если только это не локальные данные, обращение к которым осуществляется через [Power BI Gateway](../connect-data/service-gateway-onprem.md), в случае чего запрос хранит только ссылки на локальные данные.

Следующая таблица описывает данные Power BI с учетом типа используемого запроса. **X** указывает на наличие данных Power BI при использовании соответствующего типа запроса.

|                         | Используя режим Import   | DirectQuery | Live Connect  |
|-------------------------|----------|-------------|---------------|
|**Схема**               | X        | X           |               |
|**Данные строк**             | X        |             |               |
|**Кэширование данных визуальных элементов** | X        | X           | X             |

Различие между DirectQuery и другими запросами определяет, как служба Power BI обрабатывает неактивные данные и шифруется ли сам запрос. Следующие разделы описывают неактивные и перемещаемые данные, шифрование, расположение и процедуру обработки данных.

### <a name="data-at-rest"></a>Неактивные данные

Когда данные неактивны, служба Power BI сохраняет наборы данных, отчеты и плитки панелей мониторинга так, как это описано в следующих подразделах. Как было указано выше, неактивные данные в Power BI шифруются. ETL в следующих разделах обозначает извлечение, преобразование и загрузку.

#### <a name="encryption-keys"></a>Ключи шифрования

- Ключи шифрования для ключей BLOB-объектов Azure хранятся зашифрованными в Azure Key Vault.
- Ключами шифрования для технологии TDE базы данных SQL Azure управляет само решение SQL Azure.
- Ключ шифрования для службы перемещения данных и локального шлюза данных хранятся:
  - в локальном шлюзе данных в инфраструктуре клиента — для локальных источников данных;
  - в роли перемещения данных — для облачных источников данных.

Ключ шифрования содержимого (CEK), используемый для шифрования хранилища BLOB-объектов Microsoft Azure, — это случайный 256-разрядный ключ. Для шифрования содержимого CEK использует алгоритм AES\_CBC\_256.

Ключ шифрования ключей (KEK), используемый для последующего шифрования ключа CEK, представляет собой предварительно определенный 256-битный ключ. Для шифрования ключа CEK ключ KEK использует алгоритм A256KW.

Ключи шифрования шлюза на основе ключа восстановления никогда не покидают локальную инфраструктуру. Power BI не может получить доступ к зашифрованным локальным значениям учетных данных и перехватить эти данные. Веб-клиенты шифруют эти учетные данные с помощью открытого ключа, связанного с определенным шлюзом, с которым осуществляется взаимодействие.

Для облачных источников данных роль перемещения данных шифрует ключи шифрования с помощью методов [Always Encrypted](/sql/relational-databases/security/encryption/always-encrypted-database-engine). Вы можете изучить дополнительные сведения о [функции базы данных Always Encrypted](/sql/relational-databases/security/encryption/always-encrypted-database-engine).

#### <a name="datasets"></a>Наборы данных

1. Метаданные (таблицы, столбцы, меры, вычисления, строки подключения и т. п.)

    a. Для локальной версии Analysis Services в службу не записывается ничего, кроме ссылки на эту базу данных, хранящуюся зашифрованной в SQL Azure.

    b. Все остальные метаданные для извлечения, преобразования и загрузки, DirectQuery и отправки данных шифруются и размещаются в хранилище BLOB-объектов Azure.

1. Учетные данные для исходных источников данных
  
      a. Локальная версия Analysis Services — учетные данные не требуются и поэтому не хранятся.

      b. DirectQuery — зависит от того, создается ли модель непосредственно в службе (тогда данные хранятся в строке подключения и шифруются в хранилище BLOB-объектов Azure) либо импортируется из Power BI Desktop (тогда учетные данные хранятся зашифрованными в базе данных SQL Azure для перемещения данных). Ключ шифрования хранится на компьютере, где выполняется шлюз для инфраструктуры клиента.

      c. Отправленные данные — неприменимо

      d. Извлечение, преобразование и загрузка

      - Для **Salesforce** или **OneDrive** маркеры обновления хранятся зашифрованными в базе данных SQL Azure службы Power BI.
      - В противном случае:
        - Если набор данных настроен для обновления, учетные данные хранятся зашифрованными в базе данных SQL Azure для перемещения данных. Ключ шифрования хранится на компьютере, где выполняется шлюз для инфраструктуры клиента.
        - Если набор данных не настроен для обновления, учетные данные в источниках данных не хранятся.

1. Данные

    a. Локальная версия Analysis Services и DirectQuery — в службе Power BI не хранится ничего.

    b. Извлечение, преобразование и загрузка — данные зашифрованы в хранилище BLOB-объектов Azure, однако все данные, находящиеся в хранилище BLOB-объектов Azure службы Power BI, используют [Шифрование службы хранилища Azure (SSE)](/azure/storage/common/storage-service-encryption), также называемое шифрованием на стороне сервера. Multi-Geo также использует SSE.

    c. Отправка данных версии 1 — данные зашифрованы в хранилище BLOB-объектов Azure, однако все данные, находящиеся в хранилище BLOB-объектов Azure службы Power BI, используют [Шифрование службы хранилища Azure (SSE)](/azure/storage/common/storage-service-encryption), также называемое шифрованием на стороне сервера. Multi-Geo также использует SSE. Отправка push-данных версии 1 прекращена, начиная с 2016. 

    d. Отправка данных версии 2 — данные хранятся зашифрованными в SQL Azure.

Power BI использует методику шифрования на стороне клиента с использованием режима сцепления блочного шифра (CBC) со стандартом AES для шифрования своего хранилища BLOB-объектов Azure. Вы можете ознакомиться с дополнительными сведениями о [шифровании на стороне клиента](/azure/storage/common/storage-client-side-encryption).

Power BI обеспечивает мониторинг целостности данных одним из следующих способов:

* Для неактивных данных в SQL Azure служба Power BI использует DBCC, TDE и контрольную сумму константной страницы в составе собственного предложения SQL.

* Для неактивных данных в хранилище BLOB-объектов Azure служба Power BI использует шифрование на стороне клиента и HTTPS для передачи данных в хранилище, что включает в себя проверки целостности при извлечении данных. Вы можете ознакомиться с дополнительными сведениями [о безопасности хранилища BLOB-объектов](/azure/storage/blobs/security-recommendations).

#### <a name="reports"></a>Отчеты

1. Метаданные (определение отчета)

   a. Отчеты могут быть либо Excel для Microsoft 365 отчетов, либо Power BI отчетах. В зависимости от типа отчета для метаданных применимо следующее:
        
    &ensp;&ensp;а. Метаданные отчета Excel хранятся в зашифрованном виде в SQL Azure. Метаданные также хранятся в Microsoft 365.

    &ensp;&ensp;б. Power BI отчеты хранятся в зашифрованном виде в базе данных SQL Azure.

2. Статические данные

   Статические данные включают такие артефакты, как фоновые изображения и Power BI визуальные элементы.

    &ensp;&ensp;а. Для отчетов, созданных с помощью Excel для Microsoft 365, ничего не сохраняется.

    &ensp;&ensp;б. Для отчетов Power BI статические данные сохраняются и шифруются в хранилище BLOB-объектов Azure.

3. Кэши

    &ensp;&ensp;а. Для отчетов, созданных с помощью Excel для Microsoft 365, ничего не кэшируется.

    &ensp;&ensp;б. Для Power BI отчетов данные для отображаемых визуальных элементов отчетов кэшируются и сохраняются в визуальном кэше данных, описанном в следующем разделе.
 

4. Исходные файлы Power BI Desktop (PBIX) или Excel (XLSX), публикуемые в Power BI

    Иногда в хранилище BLOB-объектов Azure службы Power BI находится копия или теневая копия файлов XLSX или PBIX, в случае чего эти данные шифруются. Все такие отчеты, хранящиеся в службе Power BI в хранилище BLOB-объектов Azure, используют хранилище BLOB-объектов Azure службы Power BI, используют [Шифрование службы хранилища Azure (SSE)](/azure/storage/common/storage-service-encryption), также называемое шифрованием на стороне сервера. Multi-Geo также использует SSE.

#### <a name="dashboards-and-dashboard-tiles"></a>Панели мониторинга и их плитки

1. Кэши — данные, необходимые визуальным элементам на панели мониторинга, обычно кэшируются и хранятся в визуальном кэше данных, описанном в следующем разделе. Другие плитки, например закрепленные визуальные элементы из Excel или SQL Server Reporting Services (SSRS), хранятся в BLOB-объекте Azure в виде изображений, а также шифруются.

2. Статические данные, включающие в себя такие артефакты, как фоновые изображения и Power BI визуальных элементов, которые хранятся и шифруются в хранилище BLOB-объектов Azure.

Независимо от используемого метода шифрования, корпорация Майкрософт управляет шифрованием ключей от имени клиентов.

#### <a name="visual-data-cache"></a>Визуальный кэш данных

Визуальные данные кэшируются в разных расположениях в зависимости от того, размещается ли набор данных на Power BI Premium емкости. Для наборов данных, которые не размещаются в емкости, визуальные данные кэшируются и хранятся в зашифрованном виде в базе данных SQL Azure. Для наборов данных, размещенных в емкости, визуальные данные можно кэшировать в любом из следующих расположений:

* хранилище BLOB-объектов Azure
* Файлы Azure Premium
* Узел емкость Power BI Premium


### <a name="data-transiently-stored-on-non-volatile-devices"></a>Данные, временно хранящиеся на энергонезависимых устройствах

Устройства, не являющиеся энергонезависимыми, — это устройства с памятью, которая сохраняется без постоянного энергопотребления. Ниже описаны данные, которые временно хранятся на энергонезависимых устройствах. 

#### <a name="datasets"></a>Наборы данных

1. Метаданные (таблицы, столбцы, меры, вычисления, строки подключения и т. п.)

2. Некоторые связанные со схемами артефакты могут в течение ограниченного времени храниться на диске вычислительных узлов. Некоторые артефакты также могут храниться в кэше Redis для Azure незашифрованными в течение ограниченного времени.

3. Учетные данные для исходных источников данных

    a. Локальная версия Analysis Services — ничего не хранится

    b. DirectQuery — зависит от того, создается ли модель непосредственно в службе (тогда данные хранятся в строке подключения зашифрованными, а ключ шифрования хранится там же в открытом виде вместе с зашифрованной информацией) либо импортируется из Power BI Desktop (тогда учетные данные не сохраняются на энергонезависимых устройствах).

    > [!NOTE]
    > Функция создания модели на стороне службы прекращена, начиная с 2017.

    c. Отправленные данные — нет (неприменимо)

    d. Извлечение, преобразование и загрузка — нет (ничего не хранится на вычислительном узле и не отличается от ситуации, описанной в разделе **Неактивные данные** выше)
4. Данные

    Некоторые данные могут в течение ограниченного времени храниться на диске вычислительных узлов.

### <a name="data-in-process"></a>Обрабатываемые данные

Данные обрабатываются, когда пользователь активно использует их или обращается к ним. Например, данные обрабатываются, когда пользователь обращается к набору данных, изменяет панель мониторинга или отчет, когда происходит обновление или выполняются другие возможные операции доступа к данным. Если любое из этих событий имеет место и приводит к обработке данных, **роль данных** в службе Power BI создает выполняющуюся в памяти базу данных Analysis Services (AS), куда затем загружается набор данных. Основан ли этот набор данных на DirectQuery или нет, данные, загружаемые в базу данных AS, не шифруются, чтобы обеспечить доступ **роли данных**, и хранятся в памяти для дальнейшего доступа, пока служба Power BI не перестанет нуждаться в этом наборе данных. Для клиентов с подпиской Power BI Premium служба Power BI создает выполняющуюся в памяти базу данных Analysis Services (AS) в отдельно подготовленной коллекции виртуальных машин Power BI клиента.

После начала использования данных, что включает в себя начальную загрузку данных в Power BI, служба Power BI может кэшировать данные визуализации в зашифрованной **базе данных SQL Azure**, независимо от того, основан ли набор данных на DirectQuery.

Для отслеживания целостности обрабатываемых данных служба Power BI использует HTTPS, TCP/IP и TLS, чтобы обеспечить шифрование и целостность данных во время транспортировки.

## <a name="user-authentication-to-data-sources"></a>Проверка подлинности пользователей для источников данных

При использовании каждого источника данных пользователь устанавливает подключение на основе имени входа и обращается к данным с этими учетными данными. После этого пользователи могут создавать запросы, панели мониторинга и отчеты на основе базовых данных.

Когда пользователь предоставляет для общего доступа запросы, панели мониторинга, отчеты или любые визуализации, доступ к этим данным и визуализациям зависит от того, поддерживают ли базовые источники данных безопасность на уровне ролей (RLS).

Если базовый источник данных поддерживает **безопасность на уровне ролей (RLS) для службы Power BI******, эта служба применит такую безопасность на уровне ролей, а пользователи без достаточных учетных данных для доступа к базовым данным (которые могут быть запросом, используемым на панели мониторинга, в отчете или другом артефакте данных) не увидят данные, на которые у них отсутствуют права. Если доступ к базовым данным у пользователя не такой, как у пользователя, создавшего панели мониторинга или отчет, визуализации и другие артефакты будут показывать данные только с учетом уровня доступа этого пользователя к таким данным.

Если источник данных **не** применяет RLS, то учетные данные входа Power BI применяются к базовому источнику данных, а если при подключении указаны другие учетные данные, применяются эти данные. Когда пользователь загружает данные в службу Power BI из источников данных без RLS, эти данные хранятся в Power BI, как описано в разделе **Хранение и перемещение данных** этого документа. Для источников данных без RLS, когда данные используются совместно с другими пользователями (например, посредством панели мониторинга и отчета) или происходит обновление данных, исходные учетные данные используются для доступа к данным или их отображения.

![Безопасность на уровне ролей (RLS)](media/whitepaper-powerbi-security/powerbi-security-whitepaper_10.png)

В качестве небольшого примера для сравнения источников данных с функцией RLS и без нее представьте, что Сергей создает отчет и панель мониторинга, а затем использует их совместно с Ольгой и Дмитрием. Если источники данных, используемые в отчете и панели мониторинга, **не** поддерживают RLS, то Ольга и Дмитрий смогут просматривать данные, которые Сергей включил в панели мониторинга (которая была отправлена в службу Power BI), и взаимодействовать с ними. И наоборот, если Сергей создает отчет и панель мониторинга из источников данных, поддерживающих RLS, а затем делится ею с Ольгой и Дмитрием, то при попытке Ольги просмотреть эту панель мониторинга происходит следующее.

1. Так как панель мониторинга основана на источнике данных RLS, ее визуализации кратко отобразят сообщение о &quot;загрузке&quot;, а служба Power BI отправит запрос к источнику данных для получения текущего набора данных, который указан в строке подключения, связанной с базовым запросом панели мониторинга.

2. Обращение к данным и их извлечение осуществляются на основе учетных данных и роли Ольги, а в панель мониторинга и отчет загружаются только данные, на которые Ольга обладает достаточными правами.

3. Визуализации в панели мониторинга и отчете отображаются в зависимости от уровня роли Ольги.

Если бы Дмитрий хотел получить доступ к общей панели мониторинга или отчету, была бы реализована та же процедура с учетом его уровня роли.

## <a name="power-bi-mobile"></a>Power BI Mobile

Power BI Mobile — это набор приложений, предназначенных для трех основных мобильных платформ: Android, iOS и Windows Mobile. Аспекты безопасности для приложений Power BI Mobile делятся на две категории:

* Взаимодействие устройств
* Приложение и данные на устройстве

Что касается **взаимодействия устройств**, все приложения Power BI Mobile взаимодействуют со службой Power BI и используют те же процедуры подключения и проверки подлинности, что и браузеры, которые подробно описаны ранее в этом техническом документе. Мобильные приложения Power BI для iOS и Android используют сеанс браузера внутри самого приложения, в мобильное приложение Windows использует брокер для установления коммуникационного канала с Power BI.

В следующей таблице указана поддержка проверки подлинности на основе сертификатов (CBA) для Power BI Mobile в зависимости от платформы мобильного устройства:

| **Поддержка CBA** | **iOS** | **Android** | **Windows** |
| --- | --- | --- | --- |
| **Power BI** (вход в службу) | Поддерживается | Поддерживается | Не поддерживается |
| **SSRS ADFS** (подключение к серверу SSRS) | Не поддерживается | Поддерживается | Не поддерживается |

Приложения Power BI Mobile активно взаимодействуют со службой Power BI. Телеметрия используется для сбора статистики использования и схожих данных мобильных приложений, передаваемых службам, которые используются для отслеживания использования и активности. Вместе с телеметрией не передаются никакие персональные данные.

**Приложение Power BI на устройстве** хранит на устройстве данные, облегчающие использование приложения:

* Для хранения Azure Active Directory и маркеров обновления используется безопасный механизм на устройстве с применением типовых отраслевых мер безопасности.

* Данные кэшируются в хранилище на устройстве, которое не шифруется непосредственно самим приложением.

* Параметры также хранятся на устройстве без шифрования, однако фактические данные пользователя не сохраняются.

Кэш данных из Power BI Mobile сохраняется на устройстве в течение двух недель либо до наступления одного из следующих событий: удаление приложения, выход пользователя из Power BI Mobile или неудачная попытка входа пользователя (например, истечение срока действия токена или смена пароля). Кэш данных включает в себя панели мониторинга и отчеты, к которым ранее осуществлялся доступ из приложения Power BI Mobile.

Приложения Power BI Mobile не просматривают папки на устройстве. 

Все три платформы, для которых доступна служба Power BI Mobile, поддерживают Microsoft Intune — службу программного обеспечения, которая обеспечивает управление мобильными устройствами и приложениями. После включения и настройки Intune данные на мобильном устройстве шифруются, а само приложение Power BI не может быть установлено на SD-карту. Вы можете ознакомиться с дополнительными сведениями о [Microsoft Intune](https://www.microsoft.com/cloud-platform/microsoft-intune).

## <a name="power-bi-security-questions-and-answers"></a>Вопросы и ответы о безопасности Power BI

Ниже приведены часто задаваемые вопросы о безопасности Power BI и ответы на них. Они упорядочены по времени добавления в этот технический документ, чтобы вам было проще найти новые вопросы и ответы после обновления документа. Самые свежие вопросы находятся в конце списка.

**Как пользователи могут подключиться и получить доступ к источникам данных при использовании Power BI?**

* **Power BI учетные данные и учетные данные домена:** Пользователи входят в Power BI с помощью адреса электронной почты; Когда пользователь пытается подключиться к ресурсу данных, Power BI передает Power BI адрес электронной почты для входа в качестве учетных данных. Для ресурсов, подключенных к домену (в локальной или облачной среде), адрес электронной почты для входа сопоставляется с _именем субъекта-пользователя_ ([UPN](/windows/win32/secauthn/user-name-formats)) службой каталогов, чтобы определить наличие достаточных учетных данных для разрешения доступа. Для организаций, использующих электронные адреса электронной почты для входа в Power BI (то же письмо, которое они используют для входа в рабочие ресурсы, например _david@contoso.com_ ), сопоставление может выполняться без проблем; для организаций, не использующих адреса электронной почты на основе рабочих адресов (например _david@contoso.onmicrosoft.com_ ,), необходимо установить сопоставление каталогов, чтобы разрешить доступ к локальным ресурсам с Power BI учетных данных входа.

* **SQL Server Analysis Services и Power BI:** Для организаций, использующих локальные SQL Server Analysis Services, Power BI предлагает Power BI локальный шлюз данных (который является **шлюзом**, как указано в предыдущих разделах).  Этот локальный шлюз данных Power BI может применить для источников данных безопасность на уровне ролей (RLS). Дополнительные сведения об RLS см. в разделе **Проверка подлинности пользователей для источников данных** выше. Дополнительные сведения о шлюзах см. [в статье локальный шлюз данных](../connect-data/service-gateway-onprem.md).

  Кроме того, организации могут использовать Kerberos для **единого входа** и легко подключаться из Power BI к локальным источникам данных, таким как SQL Server, SAP HANA и Teradata. Дополнительные сведения и конкретные требования к конфигурации см. в разделе [**Использование Kerberos для единого входа из Power BI в локальные источники данных**](../connect-data/service-gateway-sso-overview.md).

* **Недоменные соединения**. для подключений к данным, которые не присоединены к домену и не поддерживают безопасность на уровне РОЛЕЙ (RLS), пользователь должен предоставить учетные данные во время последовательности подключения, которая Power BI затем передается в источник данных для установления соединения. Если разрешения достаточны, данные загружаются из источника данных в службу Power BI.

**Как данные передаются в Power BI?**

* Все данные, запрашиваемые и передаваемые службой Power BI, шифруются при передаче по протоколу HTTPS для подключения из источника данных к службе Power BI. Устанавливается безопасное соединение с поставщиком данных, и только после этого данные передаются по сети.

**Как Power BI кэширует данные отчетов, панелей мониторинга или моделей, и безопасно ли это?**

* При обращении к источнику данных служба Power BI использует процедуру, описанную в разделе **Хранение и перемещение данных** выше.

**Клиенты кэшируют данные веб-страницы локально?**

* При обращении клиентов браузера к службе Power BI ее веб-серверы задают значение _no-store_ для директивы _Cache-Control_. Директива _no-store_ предписывает браузерам не кэшировать просматриваемую пользователем веб-страницу и не сохранять ее в папке кэша клиента.

**Как насчет безопасности на основе ролей, совместного использования отчетов, информационных панелей и подключений к данным? Как это работает с точки зрения доступа к данным, просмотра панели мониторинга, доступа к отчетам или обновления?**

* Если для источников данных без поддержки **безопасности на уровне ролей (RLS)** панель мониторинга, отчет или модель данных используются совместно с другими пользователями через Power BI, эти данные доступны пользователям, с которыми осуществляется общий доступ. Power BI *не* выполняет повторную проверку подлинности пользователей для исходного источника данных. После отправки данных в Power BI пользователь, прошедший проверку подлинности для исходных данных, отвечает за управление разрешениями других пользователей и групп на просмотр этих данных.

  Когда подключения к данным устанавливаются для **RLS**-совместимого источника данных, например источника данных Analysis Services, в Power BI кэшируются только данные панелей мониторинга. При каждом просмотре отчета или набора данных или доступе к нему в Power BI с использованием данных из RLS-совместимого источника служба Power BI обращается к этому источнику для получения данных на основе учетных данных пользователя, и при наличии достаточных разрешений данные загружаются в отчет или модель данных для этого пользователя. При сбое проверки подлинности пользователь увидит ошибку.

  Дополнительные сведения см. в разделе **Проверка подлинности пользователей для источников данных** выше.

**Наши пользователи подключаются к одним и тем же источникам данных, некоторые из которых занимают учетные данные, отличающиеся от учетных данных домена. Как избежать ввода этих учетных данных при каждом подключении к данным?**

* Power BI предлагает [Power BI Personal Gateway](https://support.powerbi.com/knowledgebase/articles/649846) — функцию, позволяющую пользователям создать учетные данные для нескольких различных источников данных, а затем автоматически использовать эти данные при последующем доступе к каждому из указанных источников. Дополнительные сведения см. в разделе [Power BI Personal Gateway](https://support.powerbi.com/knowledgebase/articles/649846).

**Как работают группы Power BI?**

* Группы Power BI позволяют пользователям быстро и легко организовать совместную работу при создании панелей мониторинга, отчетов и моделей данных в рамках сформированных групп. Например, при наличии группы Power BI, которая включает всех участников вашей команды, вы можете легко работать совместно со всеми членами группы, выбрав ее в Power BI. Группы в Power BI эквивалентны универсальным группам Office 365 (вы можете узнать о них [общие сведения](https://support.office.com/Article/Find-help-about-Groups-in-Office-365-7a9b321f-b76a-4d53-b98b-a2b0b7946de1), а также научиться [создавать](https://support.office.com/Article/View-create-and-delete-Groups-in-the-Office-365-admin-center-a6360120-2fc4-46af-b105-6a04dc5461c7) их и [управлять](https://support.office.com/Article/Manage-Group-membership-in-the-Office-365-admin-center-e186d224-a324-4afa-8300-0e4fc0c3000a) ими) и используют те же механизмы проверки подлинности, которые Azure Active Directory применяет для защиты данных. Вы можете [создать группы в Power BI](https://support.powerbi.com/knowledgebase/articles/654250) или создать универсальную группу в Центре администрирования Microsoft 365 — обе операции дают аналогичный результат для создания группы в Power BI.

  Обратите внимание, что совместно используемые данные в группах Power BI регулируются теми же соображениями безопасности, что и все общие данные в Power BI. Для источников данных, **не поддерживающих RLS**, Power BI **не** выполняет повторную проверку подлинности пользователей для исходного источника данных. После отправки данных в Power BI пользователь, прошедший проверку подлинности для исходных данных, отвечает за управление разрешениями других пользователей и групп на просмотр этих данных. Дополнительные сведения см. в разделе **Проверка подлинности пользователей для источников данных** выше.

  Вы можете ознакомиться с дополнительными сведениями о [группах в Power BI](https://support.powerbi.com/knowledgebase/articles/654247).

**Какие порты используются локальным шлюзом данных и личным шлюзом? Существуют ли доменные имена, которые должны быть разрешены в целях подключения?**

* Подробный ответ на этот вопрос можно найти по следующей ссылке: [порты шлюза](/data-integration/gateway/service-gateway-communication#ports) .

**Как используются ключи восстановления при работе с локальным шлюзом данных и где они хранятся? Как насчет безопасного управления учетными данными?**

* При установке и настройке шлюза администратор вводит **ключ восстановления** шлюза. Этот **ключ восстановления** используется для создания симметричного ключа **AES** . Также создается асимметричный ключ **RSA** .

    Эти сформированные ключи (**RSA** и **AES**) хранятся в файле, расположенном на локальном компьютере. Этот файл также шифруется. Содержимое файла может расшифровать только конкретный компьютер Windows и только под этой учетной записью службы шлюза.

    Когда пользователь вводит учетные данные источника данных в пользовательском интерфейсе службы Power BI, они шифруются с помощью открытого ключа в браузере. Шлюз расшифровывает учетные данные с помощью закрытого ключа RSA и повторно шифрует их с помощью симметричного ключа AES перед сохранением данных в служба Power BI. Таким образом, у службы Power BI никогда нет доступа к незашифрованным данным.

**Какие протоколы связи используются локальным шлюзом данных и как они защищены?**

* Шлюз поддерживает два следующих протокола связи:

  - **AMQP 1,0 – TCP + TLS**: для исходящих подключений требуется открыть порты 443, 5671-5672 и 9350-9354. Этот протокол является предпочтительным, так как он имеет меньшие потери пропускной способности.

  - **HTTPS — WebSocket по протоколу HTTPS + TLS**: этот протокол использует только порт 443. WebSocket инициируется одним сообщением HTTP CONNECT. После установления канала связь осуществляется, главным образом, посредством TCP+TLS. Вы можете принудительно настроить шлюз для использования этого протокола, изменив параметр, описанный в [статье о локальном шлюзе](/data-integration/gateway/service-gateway-communication#force-https-communication-with-azure-service-bus).

**В чем заключается роль CDN Azure в Power BI?**

* Как было указано ранее, для эффективной передачи пользователям необходимого статического содержимого и файлов в соответствии с географическим расположением Power BI использует **сеть доставки содержимого Azure** (CDN). Если точнее, для эффективной передачи пользователям необходимого статического содержимого и файлов через общедоступный Интернет служба Power BI использует несколько сетей **CDN**. Статическими файлами могут быть скачиваемые продукты (например, **Power BI Desktop**, **локальный шлюз данных** или приложения Power BI от различных независимых поставщиков услуг), файлы конфигурации браузера, которые используются для инициализации и установки последующих подключений к Power BI, а также начальная безопасная страница входа в Power BI.

  На основе информации, предоставленной во время первоначального подключения к службе Power BI, браузер пользователя связывается с указанной Azure **CDN** (для некоторых файлов — с **WFE**), чтобы скачать коллекцию указанных общих файлов, необходимых для обеспечения взаимодействия браузера со службой Power BI. После этого, страница в браузере включает в себя токен AAD, сведения о сеансе, расположение соответствующего **внутреннего** кластера и коллекцию файлов, скачанных из Azure **CDN** и кластера **WFE**, за период сеанса браузера службы Power BI.

**Для Power BIных визуальных элементов Корпорация Майкрософт выполняет какие – либо оценки безопасности или конфиденциальности пользовательского визуального кода перед публикацией элемента в галерее?**

* Нет. Именно клиент отвечает за проверку и определение того, является ли код пользовательских визуальных элементов надежным. Весь код пользовательских визуальных элементов выполняется в песочнице, чтобы любые имеющиеся в нем ошибки не оказывали отрицательное влияние на остальную часть службы Power BI.

**Существуют ли другие визуальные элементы Power BI, отправляющие сведения за пределы сети клиента?**

* Да. Карты Bing и визуальные элементы ESRI передают данные за пределы службы Power BI для визуальных элементов, использующих эти службы.

**Для приложений шаблонов Корпорация Майкрософт выполняет какие – либо оценки безопасности или конфиденциальности приложения шаблона перед публикацией элементов в галерее?**
* Нет. Издатель приложения несет ответственность за содержимое, тогда как клиент отвечает за проверку и определение того, следует ли доверять издателю приложения шаблона. 

**Существуют ли приложения шаблонов, которые могут передавать данные за пределами сети клиента?**
* Да. Ответственность за проверку политики конфиденциальности издателя и определение необходимости установки приложения шаблона в клиенте несет пользователь. Кроме того, издатель несет ответственность за отправку уведомлений о поведении и возможностях приложения.

**Как насчет независимости данных? Можно ли подготавливать клиенты в центрах обработки данных, расположенных в конкретных географических регионах, чтобы данные не покидают границы страны?**

* Некоторые клиенты в определенных географических регионах могут создавать клиентов в национальном облаке, в котором хранение и обработка данных отделены от всех других центров обработки данных. В национальных облаках используется немного иной тип безопасности, так как отдельные доверенные лица по данным обеспечивают работу службы Power BI национальных облаков от имени Майкрософт.

  Кроме того, клиенты могут настроить клиент в определенном регионе, однако у таких клиентов нет отдельных доверенных лиц по данным, действующих от имени корпорации Майкрософт. Цены на национальные облака отличаются от цен на общедоступную коммерческую версию службы Power BI. Дополнительные сведения о доступности служб Power BI для национальных облаков см. в разделе [Национальные облака Power BI](https://powerbi.microsoft.com/clouds/).

**Как корпорация Майкрософт считает подключения для клиентов, у которых есть Power BI Premium подписки? Отличаются ли подключения, отличающиеся от тех, которые были установлены для служба Power BI без Premium?**

* Для подключений, установленных для клиентов с подписками Power BI Premium, применяется процесс авторизации [Azure Business-to-Business (B2B)](/azure/active-directory/active-directory-b2b-what-is-azure-ad-b2b) с использованием Azure Active Directory (AD), позволяющий реализовать управление доступом и авторизацию. Power BI обрабатывает подключения подписчиков Power BI Premium к ресурсам Power BI Premium, как и для любого другого пользователя Azure AD.

## <a name="conclusion"></a>Заключение

Архитектура службы Power BI построена на двух кластерах — внешнем веб-кластере (WFE) и внутреннем кластере. Кластер WFE отвечает за первоначальное соединение и проверку подлинности в службе Power BI, после чего все остальные операции пользователя выполняются через внутренний кластер. Для хранения удостоверений пользователей и управления ими Power BI использует Azure Active Directory (AAD), а для управления хранением данных и метаданных — соответственно BLOB-объекты Azure и базу данных SQL Azure.

Хранение и обработка данных в Power BI данных отличаются в зависимости от того, осуществляется ли доступ к данным с помощью DirectQuery, а также зависят от того, являются ли источники данных облачными или локальными. Power BI может обеспечить безопасность на уровне ролей (RLS) и взаимодействует со шлюзами, предоставляющими доступ к локальным данным.

## <a name="feedback-and-suggestions"></a>Отзывы и предложения

Ваши отзывы важны для нас! Нас интересуют любые предложения по улучшениям, дополнениям или уточнениям для этого технического документа или других материалов, связанных с Power BI. Отправьте свои предложения в [pbidocfeedback@microsoft.com](mailto:pbidocfeedback@microsoft.com) .

## <a name="additional-resources"></a>Дополнительные ресурсы

Дополнительные сведения о Power BI см. в указанных ниже ресурсах.

- [Группы в Power BI](https://support.powerbi.com/knowledgebase/articles/654247)
- [Начало работы с Power BI Desktop](https://support.powerbi.com/knowledgebase/articles/471664)
- [Обзор REST API Power BI](/rest/api/power-bi/)
- [Справочник по API Power BI](/rest/api/power-bi/)
- [On-premises data gateway (Локальный шлюз данных)](../connect-data/service-gateway-onprem.md)
- [Национальные облачные службы Power BI](https://powerbi.microsoft.com/clouds/)
- [Power BI Premium](https://aka.ms/pbipremiumwhitepaper)
- [Использование Kerberos для единого входа из Power BI в локальные источники данных](../connect-data/service-gateway-sso-overview.md)