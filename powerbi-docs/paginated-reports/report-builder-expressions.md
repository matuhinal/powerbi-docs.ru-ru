---
title: Выражения в построителе отчетов BI Power
description: Выражения часто применяются в отчетах Power BI Report Builder для извлечения, вычисления, отображения, группирования, сортировки, фильтрации, параметризации и форматирования данных.
ms.date: 06/06/2019
ms.service: powerbi
ms.subservice: report-builder
ms.topic: conceptual
ms.assetid: 76d3ac86-650c-46fe-8086-8b3edcea3882
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 96c62fec55f87a31970b624a79314656ced0c159
ms.sourcegitcommit: 7aa0136f93f88516f97ddd8031ccac5d07863b92
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/05/2020
ms.locfileid: "78921132"
---
# <a name="expressions-in-power-bi-report-builder"></a>Выражения в построителе отчетов BI Power
  Выражения часто применяются в отчетах Power BI Report Builder для извлечения, вычисления, отображения, группирования, сортировки, фильтрации, параметризации и форматирования данных. 
  
  Для многих свойств элементов отчета можно задать выражение. Выражения помогают управлять содержимым, структурой и интерактивностью отчета. Выражения составляются на языке Microsoft Visual Basic, сохраняются в определении отчета и вычисляются обработчиком отчетов при запуске отчета.  
  
 В отличие от приложений, таких как Microsoft Office Excel, где можно работать с данными напрямую на листе, в отчете вы работаете с выражениями, являющимися заполнителями для данных. Чтобы ознакомиться с фактическими данными из вычисленных выражений, нужно просмотреть отчет. Когда вы запускаете отчет, обработчик отчетов вычисляет каждое выражение, объединяя данные отчета и элементы макета отчета, такие как таблицы и диаграммы.  
  
 При проектировании отчета многие выражения для его элементов задаются автоматически. Например, когда вы перетаскиваете поле из области данных в ячейку таблицы в области конструктора отчета, значению текстового поля присваивается простое выражение для этого поля. На следующем рисунке в области данных отчета отображаются поля набора данных, ID, Name, SalesTerritory, Code и Sales. В таблицу добавлено три поля: [Name], [Code] и [Sales]. Нотация [Name] в области конструктора представляет базовое выражение `=Fields!Name.Value`.  
  
![Режим конструктора в построителе отчетов](media/report-builder-expressions/report-builder-data-design-preview.png)
  
 При предварительном просмотре отчета обработчик отчетов объединяет область табличных данных с реальными данными из подключения к данным и отображает строку в таблице для каждой строки в результирующем наборе.  
  
 Чтобы ввести выражения вручную, выберите элемент в области конструктора и используйте контекстные меню и диалоговые окна для задания свойств элемента. Когда появится кнопка ***(fx)*** или значение `<Expression>` в раскрывающемся списке, значит, вы можете задать для свойства выражение. 
  
##  <a name="understanding-simple-and-complex-expressions"></a><a name="Types"></a> Общие сведения о простых и сложных выражениях  
 Выражения начинаются со знака равенства (=) и записываются на языке Microsoft Visual Basic. Выражения могут включать сочетание констант, операторов и ссылок на встроенные значения (поля, коллекции и функции), а также на внешний и пользовательский код.  
  
 Выражения можно использовать, чтобы задавать значения различных свойств элементов отчета. Наиболее распространенными свойствами являются значения для текстовых полей и замещающего текста. Как правило, если текстовое поле содержит только одно выражение, оно является значением свойства текстового поля. Если текстовое поле содержит несколько выражений, каждое из них является значением замещающего текста в текстовом поле.  
  
 По умолчанию выражения отображаются в области конструктора отчета как *простые* или *сложные*.  
  
-   **Простое**. Простое выражение содержит ссылку на отдельный элемент во встроенной коллекции, например поле набора данных, параметр или встроенное поле. В области конструктора простое выражение отображается в скобках. Например, `[FieldName]` соответствует базовому выражению `=Fields!FieldName.Value`. Простые выражения создаются автоматически при создании макета отчета и перетаскивании элементов из области данных отчета в область конструктора. Дополнительные сведения о символах, представляющих различные встроенные коллекции, см. в разделе [Общие сведения о символах префиксов для простых выражений](#DisplayText).  
  
-   **Сложные**. Сложное выражение содержит ссылки на несколько встроенных ссылок, операторов и вызовов функций. Сложное выражение отображается как <\<Expr>>, если значение выражения включает больше отдельной ссылки. Для просмотра выражения наведите на него указатель и используйте подсказку. Чтобы изменить выражение, откройте его в диалоговом окне **Выражение**.  
  
 На следующем рисунке показаны типичные простые и сложные выражения как для текстовых полей, так и для замещающего текста.  
  
![Формат по умолчанию для выражения построителя отчетов](media/report-builder-expressions/report-builder-expression-default-format.png) 
  
 Чтобы отобразить примеры значений вместо текста для выражений, примените форматирование к текстовому полю или замещающему тексту. На следующем рисунке показана область конструктора отчетов, отображающая примеры значений:  
  
![Формат примера выражения построителя отчетов](media/report-builder-expressions/report-builder-expression-sample-values-format.png)  


## <a name="understanding-prefix-symbols-in-simple-expressions"></a><a name="DisplayText"></a> Общие сведения о символах префиксов в простых выражениях  

В простых выражениях используются символы, чтобы указать, ссылается ли оно на поле, параметр, встроенную коллекцию или коллекцию ReportItems. В следующей таблице показаны примеры отображаемого текста и текста выражения:  
  
|Элемент|Пример отображаемого текста|Пример текста выражения|  
|----------|--------------------------|-----------------------------|  
|Поля набора данных|`[Sales]`<br /><br /> `[SUM(Sales)]`<br /><br /> `[FIRST(Store)]`|`=Fields!Sales.Value`<br /><br /> `=Sum(Fields!Sales.Value)`<br /><br /> `=First(Fields!Store.Value)`|  
|Параметры отчета|`[@Param]`<br /><br /> `[@Param.Label]`|`=Parameters!Param.Value`<br /><br /> `=Parameters!Param.Label`|  
|Встроенные поля|`[&ReportName]`|`=Globals!ReportName.Value`|  
|Литеральные символы для отображения текста|`\[Sales\]`|`[Sales]`|  
  
##  <a name="writing-complex-expressions"></a><a name="References"></a> Написание сложных выражений  
 Выражения могут включать в себя ссылки на функции, операторы, константы, поля, параметры, элементы из встроенных коллекций, а также на внедренный пользовательский код или пользовательские сборки.  
  
 В следующей таблице перечислены типы ссылок, которые можно включить в выражение:  
  
|Полезные ссылки|Описание|Пример|  
|----------------|-----------------|-------------|  
|Константы|Описывает константы для свойств, требующих постоянных значений, таких как цвет шрифта; к этим константам можно получить доступ в диалоговом режиме.|`="Blue"`|  
|Операторы|Описывает операторы, которые можно использовать для объединения ссылок в выражении. Например, оператор **&** используется для объединения строк.|`="The report ran at: " & Globals!ExecutionTime & "."`|  
|Встроенные коллекции|Описывает встроенные коллекции, которые можно включить в выражение, такие как `Fields`, `Parameters` и `Variables`.|`=Fields!Sales.Value`<br /><br /> `=Parameters!Store.Value`<br /><br /> `=Variables!MyCalculation.Value`|  
|Встроенные функции отчета и агрегатные функции|Описывает встроенные функции, такие как `Sum` или `Previous`, к которым можно обратиться из выражения.|`=Previous(Sum(Fields!Sales.Value))`|  
|Пользовательский код и ссылки на сборки в выражениях в построителе отчетов |Описывает, как можно обратиться к встроенным классам среды CLR `xref:System.Math` и `xref:System.Convert`, другим классам среды CLR, функциям библиотеки времени выполнения Visual Basic или методам из внешней сборки.<br /><br /> Описывает, как можно обратиться к пользовательскому коду, внедренному в отчет либо скомпилированному и установленному в виде пользовательской сборки на клиенте отчетов и сервере отчетов.|`=Sum(Fields!Sales.Value)`<br /><br /> `=CDate(Fields!SalesDate.Value)`<br /><br /> `=DateAdd("d",3,Fields!BirthDate.Value)`<br /><br /> `=Code.ToUSD(Fields!StandardCost.Value)`|  
   
##  <a name="validating-expressions"></a><a name="Valid"></a> Проверка выражений  
 При создании выражения для определенного свойства элемента отчета ссылки, которые можно включать в выражение, зависит от значений, которые может принимать свойство элемента отчета, и области, в которой вычисляется свойство. Пример.  
  
-   По умолчанию выражение [Sum] вычисляет сумму данных, находящихся в области в момент вычисления выражения. Для табличной ячейки область действия зависит от членства в группах строк и столбцов. 
  
-   Что касается значения свойства Font, при расчете оно должно давать имя шрифта.  
  
-   Синтаксис выражения проверяется во время разработки. Проверка области выражения осуществляется при публикации отчета. Для проверки, которая зависит от фактических данных, ошибки можно обнаружить только во время выполнения. Некоторые из этих выражений выдают #Error в качестве сообщения об ошибке в отрисованном отчете. 

## <a name="next-steps"></a>Дальнейшие действия

- [Сведения об отчетах с разбивкой на страницы в Power BI Premium](paginated-reports-report-builder-power-bi.md)
