---
title: Настройка рабочих нагрузок в Power BI Premium
description: Сведения о настройке рабочих нагрузок в емкости Power BI Premium.
author: mgblythe
ms.author: mblythe
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-admin
ms.topic: conceptual
ms.date: 08/21/2019
LocalizationGroup: Premium
ms.openlocfilehash: a05924fc093c1514f51c3fabac3162433e2188f7
ms.sourcegitcommit: 9bf3cdcf5d8b8dd12aa1339b8910fcbc40f4cbe4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/05/2019
ms.locfileid: "71968890"
---
# <a name="configure-workloads-in-a-premium-capacity"></a>Настройка рабочих нагрузок в емкости Premium

Эта статья описывает включение и настройку рабочих нагрузок для емкостей Power BI Premium. По умолчанию емкости поддерживают только рабочие нагрузки, связанные с выполнением запросов Power BI. Вы можете включить и настроить дополнительные рабочие нагрузки для **[искусственного интеллекта (Cognitive Services)](service-cognitive-services.md)** , **[потоков данных](service-dataflows-overview.md#dataflow-capabilities-on-power-bi-premium)** и **[отчетов с разбивкой на страницы](paginated-reports-save-to-power-bi-service.md)** .

## <a name="default-memory-settings"></a>Параметры памяти по умолчанию

Рабочие нагрузки запросов оптимизированы для ресурсов, определенных SKU емкости Premium, и ограничены ими. Емкости Premium также поддерживают дополнительные рабочие нагрузки, способные использовать ресурсы емкости. Значения памяти по умолчанию для этих рабочих нагрузок основаны на узлах емкости, доступных для вашего номера SKU. Параметры максимального объема памяти не являются накопительными. Объем памяти до максимального указанного значения выделяется динамически для искусственного интеллекта и потоков данных, но статически для отчетов с разбивкой на страницы.

### <a name="microsoft-office-skus-for-software-as-a-service-saas-scenarios"></a>Номера SKU Microsoft Office для сценариев SaaS (программное обеспечение как услуга)

|                     | EM2                      | EM3                       | P1                      | P2                       | P3                       |
|---------------------|--------------------------|--------------------------|-------------------------|--------------------------|--------------------------|
| ИИ | Н/Д | Н/Д | По умолчанию 20 %; не менее 20 % | По умолчанию 20 %; не менее 10 % | По умолчанию 20 %; не менее 5 % |
| Потоки данных | Н/Д |По умолчанию 20 %; не менее 12 %  | По умолчанию 20 %; не менее 5 %  | По умолчанию 20 %; не менее 3 % | По умолчанию 20 %; не менее 2 %  |
| Отчеты с разбивкой на страницы | Н/Д |Н/Д | По умолчанию 20 %; не менее 10 % | По умолчанию 20 %; не менее 5 % | По умолчанию 20 %; не менее 2,5 % |
| | | | | | |

### <a name="microsoft-azure-skus-for-platform-as-a-service-paas-scenarios"></a>Номера SKU Microsoft Azure для сценариев PaaS (платформа как услуга)

|                  | A1                       | A2                       | A3                      | A4                       | A5                      | A6                        |
|-------------------|--------------------------|--------------------------|-------------------------|--------------------------|-------------------------|---------------------------|
| ИИ | Н/Д                      | По умолчанию 20 %; не менее 100 %                     | По умолчанию 20 %; не менее 50 %                     | По умолчанию 20 %; не менее 20 % | По умолчанию 20 %; не менее 10 % | По умолчанию 20 %; не менее 5 % |
| Потоки данных         | По умолчанию 40 %; не менее 40 % | По умолчанию 24 %; не менее 24 % | По умолчанию 20 %; не менее 12 % | По умолчанию 20 %; не менее 5 %  | По умолчанию 20 %; не менее 3 % | По умолчанию 20 %; не менее 2 %   |
| Отчеты с разбивкой на страницы | Н/Д                      | Н/Д                      | Н/Д                     | По умолчанию 20 %; не менее 10 % | По умолчанию 20 %; не менее 5 % | По умолчанию 20 %; не менее 2,5 % |
| | | | | | |

## <a name="workload-settings"></a>Параметры рабочей нагрузки

### <a name="ai-preview"></a>Искусственный интеллект (предварительная версия)

Рабочая нагрузка искусственного интеллекта позволяет использовать Cognitive Services и автоматизированное машинное обучение в Power BI. Используйте следующие параметры для управления поведением рабочей нагрузки.

| Имя параметра | Описание |
|---------------------------------|----------------------------------------|
| **Максимальный объем памяти (%)** | Максимальный процент доступной памяти, которую процессы ИИ могут использовать в емкости. |
| **Разрешить использование из Power BI Desktop** | Этот параметр зарезервирован для использования в будущем и может отображаться не во всех клиентах. |
| **Разрешить создание моделей машинного обучения** | Указывает, могут ли бизнес-аналитики обучать, проверять и вызывать модели машинного обучения непосредственно в Power BI. Для получения дополнительных сведений см. раздел [Автоматизированное машинное обучение в Power BI (предварительная версия)](service-machine-learning-automated.md). |
| **Включить параллелизм для запросов ИИ** | Указывает, могут ли запросы ИИ выполняться параллельно. |
|  |  |

### <a name="datasets"></a>Наборы данных

Рабочая нагрузка "Наборы данных" включена, и ее нельзя отключить. Используйте следующие параметры для управления поведением рабочей нагрузки. После таблицы приводятся дополнительные сведения, относящиеся к использованию некоторых параметров.

| Имя параметра | Описание |
|---------------------------------|----------------------------------------|
| **Максимальный объем памяти (%)** | Максимальный процент доступной памяти, которую наборы данных могут использовать в емкости. |
| **Конечная точка XMLA** | Указывает, что подключения от клиентских приложений учитывают членство в группах безопасности, настроенное на уровнях рабочей области и приложения. Дополнительные сведения см. в разделе [Подключение к наборам данных с помощью клиентских приложений и средств](service-premium-connect-tools.md). |
| **Максимальное число промежуточных наборов строк** | Максимальное число промежуточных строк, возвращаемых DirectQuery. Значение по умолчанию равно 1000000, а допустимый диапазон — от 100000 до 2147483647. |
| **Максимальный размер автономного набора данных (ГБ)** | Максимальный размер автономного набора данных в памяти. Это сжатый размер на диске. Значение по умолчанию определяется номером SKU, а допустимый диапазон — от 0,1 до 10 ГБ. |
| **Максимальное число наборов результирующих строк** | Максимальное число строк, возвращаемых в запросе DAX. Значение по умолчанию равно –1 (без ограничений), а допустимый диапазон — от 100000 до 2147483647. |
| **Предельный объем памяти для запросов (%)** | Максимальный процент доступной памяти, который может использоваться для временных результатов в запросе или мере DAX. |
| **Время ожидания запроса (в секундах)** | Максимальное количество времени до истечения времени ожидания запроса. По умолчанию здесь указано значение 3600 секунд (1 час). Значение 0 указывает, что время ожидания запросов никогда не истекает. |
|  |  |  |

#### <a name="max-intermediate-row-set-count"></a>Максимальное число промежуточных наборов строк

Этот параметр позволяет контролировать влияние ресурсоемких или плохо спроектированных отчетов. Если запрос к набору данных DirectQuery возвращает очень большой результат из базы данных-источника, это может привести к пиковой нагрузке на память или вычислительную подсистему. В такой ситуации другие пользователи и выполняющиеся отчеты могут сталкиваться с нехваткой ресурсов. С помощью этого параметра администратор емкости может ограничивать количество строк, извлекаемых отдельным запросом из источника данных.

Если по умолчанию поддерживается емкость более миллиона строк и вы работаете с большим набором данных, при необходимости можно увеличить значение этого параметра, чтобы извлекать больше строк.

Обратите внимание, что этот параметр применяется только к запросам DirectQuery. Для работы с запросами DAX используется параметр [Максимальное число наборов результирующих строк](#max-result-row-set-count).

#### <a name="max-offline-dataset-size"></a>Максимальный размер автономного набора данных

Этот параметр позволяет запретить авторам отчетов публиковать большие наборы данных, которые могут негативно сказаться на емкости. Обратите внимание, что Power BI сможет определить фактический размер в памяти только после загрузки набора данных в память. Возможны ситуации, в которых набор данных, имеющий меньший автономный размер, будет занимать в памяти больше места, чем набор большего автономного размера.

Если у вас есть набор данных, размер которого превышает значение этого параметра, при попытке пользователя получить доступ к нему произойдет сбой загрузки набора данных.

#### <a name="max-result-row-set-count"></a>Максимальное число наборов результирующих строк

Этот параметр позволяет контролировать влияние ресурсоемких или плохо спроектированных отчетов. При достижении этого ограничения для запроса DAX пользователь отчета увидит следующую ошибку. В таком случае следует скопировать сведения об ошибке и обратиться к администратору.

![Не удалось загрузить данные для этого визуального элемента](media/service-admin-premium-workloads/could-not-load-data.png)

Обратите внимание, что этот параметр применяется только к запросам DAX. Для работы с запросами DirectQuery используется параметр [Максимальное число промежуточных наборов строк](#max-intermediate-row-set-count).

#### <a name="query-memory-limit"></a>Предельный объем памяти для запросов

Этот параметр позволяет контролировать влияние ресурсоемких или плохо спроектированных отчетов. При выполнении некоторых запросов и вычислений могут получаться промежуточные результаты, которые занимают большой объем памяти в выделенной емкости. В такой ситуации возможны значительное замедление других запросов, исключение других наборов данных из выделенной емкости, а также возникновение ошибок, связанных с нехваткой памяти, для других пользователей выделенной емкости.

Этот параметр применяется к операциям обновления данных и подготовки отчета к просмотру. При обновлении одновременно обновляются данные из источника и сам запрос, кроме случаев, когда обновление запросов отключено. Если обновление запросов разрешено, это ограничение объема памяти будет применяться также и к ним. В случае сбоя любого запроса в состоянии запланированного обновления будет указываться ошибка, даже если обновление данных было выполнено успешно.

#### <a name="query-timeout"></a>Время ожидания запроса

С помощью этого параметра обеспечивается эффективное управление долго выполняющимися запросами, которые могут привести к замедлению загрузки отчетов для пользователей. Этот параметр применяется к операциям обновления данных и подготовки отчета к просмотру. При обновлении одновременно обновляются данные из источника и сам запрос, кроме случаев, когда обновление запросов отключено. Если обновление запросов разрешено, ограничение времени ожидания будет применяться также и к ним.

Этот параметр применяется к отдельному запросу, а не к продолжительности выполнения всех запросов, связанных с обновлением набора данных или отчета. Рассмотрим следующий пример.

- Параметру **Время ожидания запроса** присвоено значение 1200 (20 минут).
- Требуется выполнить пять запросов, на каждый из которых затрачивается 15 минут.

Совокупное время выполнения всех запросов составляет 75 минут, однако заданное параметром ограничение не достигается, поскольку каждый отдельный запрос выполняется менее 20 минут.

Обратите внимание, что в отчетах Power BI это значение по умолчанию переопределяется, и для каждого запроса к выделенной емкости устанавливается гораздо меньшее время ожидания. Как правило, время ожидания для каждого запроса составляет около трех минут.

### <a name="dataflows"></a>Потоки данных

Рабочая нагрузка потоков данных позволяет использовать самостоятельную подготовку к работе с потоками данных для приема, преобразования, интеграции и обогащения данных. Используйте следующие параметры для управления поведением рабочей нагрузки.

| Имя параметра | Описание |
|---------------------------------|----------------------------------------|
| **Максимальный объем памяти (%)** | Максимальный процент доступной памяти, которую потоки данных могут использовать в емкости. |
| **Улучшенная подсистема вычислений для потоков данных (предварительная версия)** | Включите этот параметр, чтобы в 20 раз быстрее рассчитывать вычисляемые сущности при работе с большими объемами данных. **Для активации нового модуля необходимо перезапустить емкость.** Дополнительные сведения см. в разделе [Улучшенная подсистема вычислений для потоков данных](#enhanced-dataflows-compute-engine). |
| **Размер контейнера** | Максимальный размер контейнера, используемого потоками данных для каждой сущности в потоке данных. По умолчанию используется 700 МБ. Для получения дополнительных сведений см. раздел [Размер контейнера](#container-size). |
|  |  |

#### <a name="enhanced-dataflows-compute-engine"></a>Улучшенная подсистема вычислений для потоков данных

Чтобы воспользоваться преимуществами новой подсистемы вычислений, разделите прием данных на отдельные потоки и поместите логику преобразования в вычисляемые сущности в разных потоках данных. Этот подход рекомендуется, так как подсистема вычислений работает с потоками данных, которые ссылаются на существующий поток данных. Она не работает с потоками данных приема. Следуя этим указаниям, вы гарантируете, что новый модуль вычислений будет обрабатывать шаги преобразования, такие как соединения и объединения, для достижения оптимальной производительности.

#### <a name="container-size"></a>Размер контейнера

При обновлении потока данных рабочая нагрузка порождает контейнер для каждой сущности в потоке данных. Каждый контейнер может использовать память вплоть до объема, указанного в параметре **Размер контейнера. Значение по умолчанию для всех номеров SKU — 700 МБ. Этот параметр может потребоваться изменить в указанных ниже случаях.

- Обновление потоков данных занимает слишком много времени или завершается сбоем из-за истечения времени ожидания.
- Сущности потоков данных включают в себя вычислительные этапы, например соединение.  

Для анализа производительности рабочей нагрузки "Потоки данных" рекомендуется использовать [приложение метрик емкости Power BI Premium](service-admin-premium-monitor-capacity.md).

В некоторых случаях увеличение размера контейнера может не привести к повышению производительности. Например, если поток данных просто получает данные из источника, не выполняя значительных вычислений, изменение размера контейнера, скорее всего, не даст результата. Увеличение размера контейнера может помочь, если оно даст рабочей нагрузке потока данных возможность выделить больше памяти для операций обновления сущности. Выделение большего объема памяти может сократить время, затрачиваемое на обновление сущностей с большим объемом вычислений.

Значение параметра "Размер контейнера" не может превышать максимальный объем памяти для рабочей нагрузки "Потоки данных". Например, емкость P1 имеет 25 ГБ памяти. Если максимальный объем памяти для рабочей нагрузки потока данных (в процентах) установлен в значение 20 %, размер контейнера (в МБ) не может превышать 5000. Размер контейнера в любом случае не может превышать максимальный объем памяти, даже если задано более высокое значение.

### <a name="paginated-reports"></a>Отчеты с разбивкой на страницы

Рабочая нагрузка отчетов с разбивкой на страницы позволяет запускать отчеты с разбивкой на страницы на основе стандартного формата SQL Server Reporting Services в службе Power BI. Используйте следующие параметры для управления поведением рабочей нагрузки.

| Имя параметра | Описание |
|---------------------------------|----------------------------------------|
| **Максимальный объем памяти (%)** | Максимальный процент доступной памяти, которую отчеты с разбивкой на страницы могут использовать в емкости. |
|  |  |

Отчеты с разбивкой на страницы позволяют запускать собственный код для отрисовки отчета. Например, можно динамически изменять цвет текста в зависимости от содержимого, для чего требуется дополнительная память. Power BI Premium выполняет отчеты с разбивкой на страницы в автономной области в пределах емкости. Указанный максимальный объем памяти используется *независимо* от активности рабочей нагрузки. Если вы изменяете максимальный объем памяти по умолчанию, устанавливайте его не слишком большим, чтобы работа других рабочих нагрузок не ухудшилась.

В некоторых случаях рабочая нагрузка отчетов с разбивкой на страницы может стать недоступной. В такой ситуации для этой рабочей нагрузки на портале администрирования отображается состояние ошибки, а пользователи при отрисовке отчета получают сообщения о превышении времени ожидания. Чтобы устранить эту проблему, отключите эту рабочую нагрузку и снова включите ее.

## <a name="configure-workloads"></a>Настройка рабочих нагрузок

Вы можете максимально увеличить емкость доступных ресурсов, включая рабочие нагрузки, только если они будут использоваться. Изменяйте параметры памяти и другие параметры, только если значения по умолчанию не соответствуют требованиям к ресурсам емкости.

### <a name="to-configure-workloads-in-the-power-bi-admin-portal"></a>Настройка рабочих нагрузок на портале администрирования Power BI

1. Выберите емкость в разделе **Параметры емкости** > **Емкости Premium**.

1. В разделе **Дополнительно** разверните **Рабочие нагрузки**.

1. Включите одну или несколько рабочих нагрузок и задайте значения для параметра **Максимальный объем памяти** и других параметров.

1. Нажмите кнопку **Применить**.

### <a name="rest-api"></a>API-интерфейсы REST

Рабочие нагрузки можно включить и назначить емкости с помощью REST API [емкостей](https://docs.microsoft.com/rest/api/power-bi/capacities).

## <a name="monitoring-workloads"></a>Мониторинг рабочих нагрузок

[Приложения метрик емкости Power BI Premium](service-admin-premium-monitor-capacity.md) предоставляет метрики, связанные с наборами данных, потоками данных и отчетами с разбивкой на страницы, для мониторинга рабочих нагрузок, которые включены для ваших емкостей. 

## <a name="next-steps"></a>Дальнейшие действия

[Оптимизация емкостей Power BI Premium](service-premium-capacity-optimize.md)     
[Самостоятельная подготовка данных в Power BI с помощью потоков данных](service-dataflows-overview.md)   
[Сведения об отчетах с разбивкой на страницы в Power BI Premium](paginated-reports-report-builder-power-bi.md)   

Появились дополнительные вопросы? [Спросить в сообществе Power BI](http://community.powerbi.com/)