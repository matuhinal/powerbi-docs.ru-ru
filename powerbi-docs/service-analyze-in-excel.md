---
title: Анализ в Excel данных Power BI
description: Сведения об анализе наборов данных Power BI в Excel
author: davidiseminger
ms.reviewer: ''
ms.custom: seodec18
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 02/13/2020
ms.author: davidi
LocalizationGroup: Reports
ms.openlocfilehash: df905c4174c366f64b58d257786f002c607f3edb
ms.sourcegitcommit: 7aa0136f93f88516f97ddd8031ccac5d07863b92
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/05/2020
ms.locfileid: "81675664"
---
# <a name="analyze-in-excel"></a>Анализ в Excel
Бывают ситуации, когда для просмотра набора данных из Power BI и работы с ним требуется использовать Excel. Это можно сделать с помощью компонента **Анализ в Excel**, позволяющей получить доступ к функциям сводных таблиц, диаграмм и срезов в Excel для набора данных, имеющегося в Power BI.

## <a name="requirements"></a>Требования
К использованию **анализа в Excel** предъявляется ряд требований:

* Компонент **Анализ в Excel** поддерживается в Microsoft Excel 2010 с пакетом обновления 1 и более поздних версиях.

* Сводные таблицы Excel не поддерживают агрегирование числовых полей перетаскиванием. В наборе данных Power BI *должны быть заранее определенные меры*. Прочитайте о [создании мер](desktop-measures.md).
* В некоторых организациях могут действовать правила групповой политики, которые запрещают устанавливать необходимые обновления **Анализ в Excel**. Если вам не удается их установить, обратитесь к своему администратору.
* **Анализ в Excel** требует, чтобы набор данных размещался в Power BI Premium или у пользователя была лицензия Power BI Pro. Дополнительные сведения о различиях в функциональных возможностях между разными типами лицензий Power BI см. в разделе _Сравнение функций Power BI_ на странице [Цены на Power BI](https://powerbi.microsoft.com/pricing/).
* Пользователи могут подключаться к наборам данных через Анализ в Excel, если у них есть разрешение для базового набора данных.  Это разрешение можно получить разными способами, например через роль члена рабочей области, содержащей набор данных, наличие доступа к отчету или панели мониторинга, где используется набор, либо наличие разрешения на сборку для набора данных в рабочей области или в содержащем набор приложении. Дополнительные сведения о [разрешении на сборку](service-datasets-build-permissions.md) для наборов данных.
* Функция **Анализировать в Excel** относится к службе Power BI и недоступна для сервера отчетов Power BI или Power BI Embedded. 
* **Анализ в Excel** поддерживается только на компьютерах под управлением Microsoft Windows.

## <a name="how-does-it-work"></a>Принципы работы
При выборе команды **Анализировать в Excel** в меню **Дополнительные параметры (...)** , связанном с набором данных или отчетом в **Power BI**, Power BI создает ODC-файл и скачивает его из браузера на ваш компьютер.

![Анализ в Excel](media/service-analyze-in-excel/power-bi-analyze-in-excel.png)

При открытии этого файла в Excel отображается пустая **сводная таблица** и список **Поля** со всеми таблицами, полями и мерами из набора данных Power BI. Вы можете создавать сводные таблицы, диаграммы и анализировать набор данных точно так же, как и при использовании любого локального набора данных в Excel.

ODC-файл использует строку подключения MSOLAP для соединения с набором данных в Power BI. При анализе данных или работе с ними Excel отправляет запросы к набору данных Power BI, и результаты возвращаются обратно в Excel. Если набор данных подключен к динамическому источнику с помощью DirectQuery, Power BI отправляет запросы к этому источнику и возвращает результаты в Excel.

Компонент **Анализ в Excel** очень удобно использовать для работы с наборами данных и отчетами, которые подключаются к *табличным* или *многомерным базам данных в службах Analysis Services* либо находятся в файлах Power BI Desktop и книгах Excel с моделями данных, содержащими меры модели, которые были созданы с помощью языка выражений анализа данных (DAX).

## <a name="get-started-with-analyze-in-excel"></a>Приступая к анализу в Excel
В Power BI щелкните меню **Дополнительные параметры** рядом с отчетом или набором данных (многоточие рядом с именем отчета или набора данных). В появившемся меню выберите **Анализ в Excel**.

![Анализ в Excel](media/service-analyze-in-excel/power-bi-analyze-menu.png)

### <a name="install-excel-updates"></a>Установка обновлений для Excel
При первом использовании компонента **Анализ в Excel** потребуется установить обновления для библиотек Excel. Вам будет предложено скачать и запустить обновления Excel (при этом запускается установка пакета установщика Windows *SQL_AS_OLEDDB.msi*). Этот пакет устанавливает **поставщик OLE DB Microsoft AS для сервера SQL Server 2016 RC0 (предварительная версия)** .

> [!NOTE]
> Не забудьте установить флажок **Больше не показывать** в диалоговом окне **Установка обновлений Excel**. Это обновление необходимо установить только один раз.
> 
> 

![Флажок "Больше не показывать"](media/service-analyze-in-excel/pbi_anlz_excel_dontshow.png)

Если вам снова требуется установить обновления Excel для компонента **Анализ в Excel**, можно скачать такое обновление с помощью значка **скачивания** в Power BI, как показано на следующем рисунке.

![Установка обновлений](media/service-analyze-in-excel/pbi_anlz_excel_download_again.png)

### <a name="sign-in-to-power-bi"></a>Вход в Power BI
Даже если вы уже вошли в Power BI в браузере, в первый раз при открытии нового ODC-файла в Excel вам, возможно, потребуется снова войти в эту службу со своей учетной записью Power BI. При это выполняется проверка подлинности соединения из Excel в Power BI.

### <a name="users-with-multiple-power-bi-accounts"></a>Пользователи с несколькими учетными записями Power BI
Некоторые пользователи имеют несколько учетных записей Power BI и могут столкнуться с ситуацией, когда они вошли в Power BI с помощью одной учетной записи, но доступ к набору данных, используемому при анализе в Excel, имеет другая учетная запись. В этом случае при попытке доступа к набору данных, используемому в книге анализа в Excel, может возникать ошибка **Запрещено** или ошибка входа в систему.

При этом вы сможете повторно войти в систему с помощью учетной записи Power BI, имеющей доступ к набору данных, используемому при анализе в Excel. Вы также можете выбрать свое имя на верхней ленте в Excel. Оно указывает, с какой учетной записью вы выполнили вход в систему. Выйдите из системы и войдите в другую учетную запись.

### <a name="enable-data-connections"></a>Включение подключений к данным
Чтобы приступить к анализу данных Power BI в Excel, проверьте имя и путь ODC-файла и нажмите кнопку **Разрешить**.

![Включение подключений к данным](media/service-analyze-in-excel/pbi_anlz_excel_enable.png)

> [!NOTE]
> Администраторы клиентов Power BI могут использовать *портал администрирования Power BI*, чтобы отключить функцию **Анализировать в Excel** для работы с локальными наборами данных, размещенными в базах данных Analysis Services (AS). Если этот параметр отключен, функция **Анализировать в Excel** будет отключена для баз данных AS, но по-прежнему будет доступна для работы с другими наборами данных.
> 
> 

## <a name="analyze-away"></a>Анализ
Теперь, когда Excel открыт и отображается пустая сводная таблица, вы можете выполнять для набора данных Power BI любые виды анализа. Как и другие локальные книги, анализа в Excel позволяет создавать сводные таблицы, диаграммы, добавлять данные из других источников и т. п. И конечно же, вы может создавать различные листы для работы с ними в любых представлениях.

![Сводная таблица и сводная диаграмма в Excel](media/service-analyze-in-excel/pbi_anlz_excel_chart.png)

> [!NOTE]
> Необходимо знать, что использование функции **анализа в Excel** предоставляет все данные на уровне детализации для всех пользователей с разрешением на набор данных.
> 
> 

## <a name="save"></a>Сохранить
Эту книгу, подключенную к набору данных Power BI, можно сохранить так же, как и любую другую. При этом ее нельзя опубликовать или импортировать обратно в Power BI,так как для публикации или импорта данные в книге должны содержаться в таблицах или использовать модель данных. Так как в новой книге есть только подключение к набору данных в Power BI, ее публикация или импорт в Power BI привели бы к возникновению замкнутого цикла.

## <a name="share"></a>Общий доступ
Сохранив книгу, вы можете предоставить доступ к ней другим пользователям Power BI в своей организации.

Когда такой пользователь откроет вашу книгу в первый раз, он увидит в ней сводные таблицы и данные в том состоянии, в каком они были на момент последнего сохранения (то есть они могут быть неактуальны). Чтобы обновить данные до текущей версии, потребуется нажать кнопку **Обновить** на ленте **Данные**. А так как книга подключается к набору данных в Power BI, пользователи, пытающиеся обновить книгу, должны будут войти в эту службу и установить обновления для Excel (только в первый раз).

Так как пользователям потребуется обновить набор данных, а обновление внешних подключений в Excel Online не поддерживается, рекомендуется открывать такие книги в классическом приложении Excel на компьютере.

## <a name="troubleshooting"></a>Устранение неполадок
В некоторых случаях функция анализа в Excel дает неожиданный результат или работает не так, как нужно. [На этой странице представлены решения наиболее распространенных проблем, возникающих при работе с функцией анализа в Excel.](desktop-troubleshooting-analyze-in-excel.md)

## <a name="next-steps"></a>Дальнейшие действия

Рекомендуем также ознакомиться со следующими материалами:

* [Использование детализации между отчетами в Power BI Desktop](desktop-cross-report-drill-through.md)
* [Использование срезов в Power BI Desktop](visuals/power-bi-visualization-slicers.md)

