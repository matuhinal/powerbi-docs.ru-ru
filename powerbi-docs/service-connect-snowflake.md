---
title: Подключение к Snowflake с помощью Power BI
description: Snowflake с единым входом для Power BI
author: cpopell
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 11/20/2019
ms.author: gepopell
LocalizationGroup: Connect to services
ms.openlocfilehash: 03e6e8efae5cd4a5f61e3d07bc0b3c524b3b0a46
ms.sourcegitcommit: d6a48e6f6e3449820b5ca03638b11c55f4e9319c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/18/2020
ms.locfileid: "77429356"
---
#  <a name="connecting-to-snowflake-in-power-bi-service"></a>Подключение к Snowflake в службе Power BI

## <a name="introduction"></a>Введение

Подключение к Snowflake в службе Power BI имеет одно отличие от использования других соединителей. Оно заключается в наличии дополнительной возможности интеграции с AAD (с поддержкой единого входа). Для разных компонентов интеграции требуются разные административные роли в Snowflake, Power BI и Azure. Вы также можете включить проверку подлинности посредством AAD без использования единого входа. Обычная проверка подлинности работает так же, как и с другими соединителями службы.

Если вас интересует настройка интеграции с AAD, а также обеспечение единого входа, обратитесь к приведенным ниже ресурсам.
* Если вы являетесь администратором Snowflake, ознакомьтесь со статьей [Power BI SSO to Snowflake — Getting Started](https://docs.snowflake.net/manuals/LIMITEDACCESS/oauth-powerbi.html) (Начало работы с единым входом из Power BI в Snowflake) в документации по Snowflake.
* (Единый вход) Если вы являетесь администратором Power BI, ознакомьтесь с разделом "Настройка службы Power BI — Портал администрирования".
* (Единый вход) Если вы являетесь создателем наборов данных Power BI, ознакомьтесь с разделом "Настройка службы Power BI — Включение набора данных".

## <a name="power-bi-service-configuration"></a>Настройка службы Power BI

### <a name="admin-portal"></a>Портал администрирования

Если вы хотите включить единый вход, администратору клиента нужно перейти на портал администрирования и одобрить отправку учетных данных Power BI из AAD в Snowflake.

![Настройка единого входа в Snowflake администратором клиента](media/service-connect-snowflake/snowflakessotenant.png)

Перейдите на портал администрирования, выберите на боковой панели пункт "Параметры клиента", прокрутите содержимое вниз до раздела "Настройки интеграции", в котором есть параметр "Единый вход Snowflake".

Как указано в предупреждении, необходимо вручную включить этот параметр, чтобы разрешить отправку токена AAD на серверы Snowflake. Чтобы включить его, переведите переключатель в положение "Включено", нажмите кнопку "Применить" и дождитесь вступления изменения в силу. Распространение конфигурации в службе может занять до одного часа.

После этого вы сможете использовать отчеты с единым входом.

### <a name="configuring-a-dataset-with-aad"></a>Настройка набора данных с AAD

После публикации отчета на основе соединителя со Snowflake в веб-службе Power BI создателю набора данных необходимо перейти в соответствующую рабочую область, выбрать элемент "Наборы данных", а затем выбрать пункт "Параметры" (в меню дополнительных действий ["..."] рядом с соответствующим набором данных).

Из-за особенностей работы Power BI единый вход возможен только для источников данных, подключение к которым выполняется не через локальный шлюз данных.

* Если в модели данных используется только источник Snowflake, то можно использовать единый вход при условии, что локальный шлюз данных не применяется.
* Если источник Snowflake используется наряду с другим источником, то единый вход возможен при условии, что локальный шлюз данных не применяется ни для одного из источников.
* Если источник Snowflake используется через локальный шлюз данных, можно применять учетные данные AAD, но не единый вход. Это может быть важно в случае, если обращение к виртуальной сети происходит с одного IP-адреса с установленным шлюзом, а не из всего диапазона IP-адресов Power BI.
* Если источник Snowflake используется наряду с другим источником, требующим шлюза, то источник Snowflake также должен будет использоваться через локальный шлюз данных и единый вход будет невозможен.

Дополнительные сведения об использовании локального шлюза данных см. в статье [Что такое локальный шлюз данных?](https://docs.microsoft.com/power-bi/service-gateway-onprem)

Если шлюз не используется, то настройка завершена. Если в локальном шлюзе данных настроены учетные данные Snowflake, но источник данных используется только в модели, можно щелкнуть переключатель на странице "Параметры набора данных", чтобы отключить шлюз для этой модели данных.

![Параметр набора данных для отключения шлюза](media/service-connect-snowflake/snowflake_gateway_toggle_off.png)

Создателю набора данных необходимо выбрать "Учетные данные источника данных" и выполнить вход. Выполнить вход в Snowflake можно либо с помощью обычных учетных данных, либо с помощью учетных данных OAuth2 (AAD). Если вы решили использовать AAD, для набора данных можно включить единый вход. Когда первый пользователь выполняет вход в Snowflake для доступа к набору данных, ему нужно выбрать параметр, предписывающий другим пользователям использовать свои учетные данные Oauth2 для получения данных. В результате будет включен единый вход AAD. Независимо от того, входит ли первый пользователь в систему с помощью обычной проверки подлинности или OAuth2 (AAD), для единого входа будут передаваться учетные данные AAD. 

![Настройка набора данных для единого входа в Snowflake](media/service-connect-snowflake/snowflakessocredui.png)

В дальнейшем все пользователи должны автоматически подключаться к этому набору данных Snowflake с помощью своих учетных данных AAD.

Если вы решили не включать единый вход, то при обновлении отчета пользователи будут использовать учетные данные пользователя, выполнившего вход, как и в случае с большинством других отчетов Power BI.

### <a name="troubleshooting"></a>Устранение неполадок

При возникновении проблем с интеграцией обратитесь к [руководству по устранению неполадок](https://docs.snowflake.net/manuals/LIMITEDACCESS/oauth-powerbi.html#troubleshooting) Snowflake.

