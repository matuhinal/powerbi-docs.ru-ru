---
title: Экспорт данных из визуализации Power BI
description: Экспортируйте данные из визуализаций отчетов и панелей мониторинга и просматривайте их в Excel.
author: mihart
manager: kvivek
ms.reviewer: tessa
featuredvideoid: jtlLGRKBvXY
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 04/28/2020
ms.author: mihart
LocalizationGroup: Visualizations
ms.openlocfilehash: 49e4653152e8981222d3a2589781546eb25bcd0e
ms.sourcegitcommit: 0e9e211082eca7fd939803e0cd9c6b114af2f90a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/13/2020
ms.locfileid: "83273024"
---
# <a name="export-the-data-that-was-used-to-create-a-visualization"></a>Экспорт данных, использованных для создания визуализации

> [!IMPORTANT]
> Не все данные могут быть просмотрены или экспортированы всеми пользователями. Существуют меры предосторожности, которые создатели и администраторы отчетов используют при создании панелей мониторинга и отчетов. Некоторые данные ограничены, скрыты или конфиденциальны и не могут быть просмотрены или экспортированы без специальных разрешений. 

## <a name="who-can-export-data"></a>Кто может экспортировать данные

Если у вас есть разрешения на доступ к данным, можно просмотреть и экспортировать данные, которые Power BI использует для создания визуализации. Часто данные бывают конфиденциальными или доступны только конкретным пользователям. В таких случаях вы не сможете просматривать или экспортировать эти данные. Дополнительные сведения см. в разделе **Ограничения и рекомендации** в конце этого документа. 


## <a name="viewing-and-exporting-data"></a>Просмотр и экспорт данных

Чтобы просмотреть данные, которые Power BI использует для создания визуализации, [откройте их в Power BI](service-reports-show-data.md). Вы также можете экспортировать данные в Excel в виде файла *XLSX* или *CSV*. Для экспорта данных требуется лицензия Pro или Премиум и права на редактирование набора данных и отчета. <!--If you have access to the dashboard or report but the data is classified as *highly confidential*, Power BI will not allow you to export the data.-->

Просмотрите видео, в котором показан экспорт данных из визуализации в отчете и сохранение их в файл *XLSX* с последующим просмотром в Excel. Затем сделайте то же самое, выполнив пошаговые инструкции, приведенные под видео. Обратите внимание, что в этом видео используется более старая версия Power BI.

<iframe width="560" height="315" src="https://www.youtube.com/embed/KjheMTGjDXw" frameborder="0" allowfullscreen></iframe>

## <a name="export-data-from-a-power-bi-dashboard"></a>Экспорт данных из панели мониторинга Power BI

1. Выберите "Дополнительные действия" (...) в правом верхнем углу визуализации.

    ![Снимок экрана: визуализация со стрелкой, указывающей на кнопку с многоточием.](media/power-bi-visualization-export-data/pbi-export-tile3.png)

1. Выберите параметр **Экспорт в CSV**.

    ![Снимок экрана: раскрывающийся список кнопки с многоточием с выделенным параметром экспорта данных.](media/power-bi-visualization-export-data/power-bi-export-data.png)

1. Power BI экспортирует данные в файл *CSV*. Если выполнить фильтрацию визуализации, экспорт CSV также будет отфильтрован. 

1. Браузер предложит сохранить файл.  Откройте сохраненный файл *CSV* в Excel.

    ![Снимок экрана: файл CSV, отображающий экспортированные данные.](media/power-bi-visualization-export-data/pbi-export-to-excel.png)

## <a name="export-data-from-a-report"></a>Экспорт данных из отчета

Для начала откройте [отчет по примеру анализа закупок](../create-reports/sample-procurement.md) в службе Power BI в представлении редактирования. Добавьте новую пустую страницу отчета. Затем выполните следующие действия, чтобы добавить агрегирование, иерархию и фильтры уровня визуализации.

### <a name="create-a-stacked-column-chart"></a>Создание гистограммы с накоплением

1. Создайте **гистограмму с накоплением**.

    ![Снимок экрана: шаблон гистограммы с группировкой.](media/power-bi-visualization-export-data/power-bi-clustered.png)

1. В области **Поля** выберите **Location > City** (Расположение > Город), **Location > Country/Region** (Расположение > Страна/регион) и **Invoice > Discount Percent** (Счет > Процент скидки).  Возможно, нужно будет переместить **Discount Percent** (Процент скидки) в область **Значение**.

    ![Снимок экрана: создаваемая визуализация с выделенными параметрами City (Город) и Count of Discount Percent (Число процента скидки).](media/power-bi-visualization-export-data/power-bi-build.png)

1. Измените тип агрегации для **процента скидки** с **количества** на **среднее значение**. В области **Значение** щелкните стрелку справа от параметра **Discount Percent** (Процент скидки) (он может называться **Count of Discount Percent** (Число процента скидки)) и выберите значение **Average** (Среднее значение).

    ![Снимок экрана: список вариантов агрегирования с выделенным параметром "Среднее значение".](media/power-bi-visualization-export-data/power-bi-export-data6.png)

1. Добавьте фильтр к параметру **City** (Город), выберите все города, а затем удалите город **Атланта**.

    ![Снимок экрана: фильтр параметра City (Город) с убранным флажком напротив "Атланта, штат Джорджия".](media/power-bi-visualization-export-data/power-bi-filter.png)

   
1. Детализация на один уровень вниз в иерархии. Включите детализацию и выберите детализацию до уровня **City** (Город). 

    ![Снимок экрана: визуальный элемент с детализацией до уровня City.](media/power-bi-visualization-export-data/power-bi-drill.png)

Теперь можно попробовать оба варианта для экспорта данных.

### <a name="export-summarized-data"></a>Экспорт ***сводных*** данных
Выберите вариант **Сводные данные**, если вы хотите экспортировать данные, которые отображаются в этом визуальном элементе.  Этот тип экспорта отображает только данные (столбцы и меры), которые вы выбрали для создания визуального элемента.  Если визуальный элемент содержит статистическое выражение, будут экспортированы объединенные данные. Например, если в гистограмме отображается четыре столбца, вы получите четыре строки данных Excel. Сводные данные доступны в службе Power BI в файлах *XLSX* и *CSV* и в Power BI Desktop в виде CSV-файла.

1. Щелкните многоточие в правом верхнем углу визуализации. Выберите пункт **Экспорт данных**.

    ![Снимок экрана: кнопка с многоточием в правом верхнем углу и выделенный параметр "Экспорт данных".](media/power-bi-visualization-export-data/power-bi-export-data2.png)

    В службе Power BI визуализация имеет агрегат (вы изменили параметр **Число** на *среднее*), поэтому у вас есть два варианта:

    - **Сводные данные**;

    - **Базовые данные**.

    Дополнительные сведения о статистических выражениях см. в статье [Статистические выражения в Power BI](../create-reports/service-aggregates.md).


    > [!NOTE]
    > В Power BI Desktop вы можете экспортировать только сводные данные в виде CSV-файла. 
    
    
1. В области **Экспорт данных** установите переключатель **Сводные данные** или выберите *XLSX* или *CSV*, а затем нажмите кнопку **Экспорт**. Power BI экспортирует данные.

    ![Снимок экрана: снимок экрана экспорта данных с выделенными параметрами "Сводные данные", "XLSX" и "Экспорт".](media/power-bi-visualization-export-data/power-bi-export-data5.png)

1. При выборе элемента **Экспорт** браузер предложит сохранить файл. Откройте сохраненный файл в программе Excel.

    ![Снимок экрана: выходные данные Excel.](media/power-bi-visualization-export-data/power-bi-export-data9.png)

    В этом примере в экспортированных данных Excel отображается итоговая сумма для каждого города. Так как мы исключили Атланту, этого города нет в результатах. В первой строке электронной таблицы отображаются фильтры, которые служба Power BI использовала при извлечении данных.
    
    - Экспортируются все данные, используемые иерархией, а не только данные, используемые для текущего уровня детализации визуального элемента. Например, мы выполняли детализацию по уровню City, но наш экспорт включает также данные о стране.  

    - Экспортированные данные агрегированы. Мы получаем итог, по одной строке для каждого города.

    - Так как мы применили фильтры к визуализации, экспортированные данные будут экспортированы с учетом фильтров. Обратите внимание, что первая строка отображает **Примененные фильтры: город — не Атланта, штат Джорджия**. 

### <a name="export-underlying-data"></a>Экспорт ***базовых*** данных

Выберите этот вариант, если вы хотите просмотреть данные в визуальном элементе ***и*** дополнительные данные из набора данных (дополнительные сведения см. в диаграмме ниже). Если визуализация содержит статистическое выражение, при выборе варианта **Базовые данные** статистическое выражение удаляется. В этом примере в экспортированных данных Excel отображается по одной строке для каждой строки "Город" в наборе данных и процент скидки для одной записи. Power BI выполняет сведение данных, но не агрегирование.  

Когда вы нажмете кнопку **Экспорт**, Power BI экспортирует данные в файл *XLSX* и браузер предложит сохранить этот файл. Откройте сохраненный файл в программе Excel.

1. Щелкните многоточие в правом верхнем углу визуализации. Выберите пункт **Экспорт данных**.

    ![Снимок экрана: кнопка с многоточием в правом верхнем углу и выделенный параметр "Экспорт данных".](media/power-bi-visualization-export-data/power-bi-export-data2.png)

    В службе Power BI визуализация имеет агрегат (вы изменили параметр **Число** на **среднее**), поэтому у вас есть два варианта:

    - **Сводные данные**;

    - **Базовые данные**.

    Дополнительные сведения о статистических выражениях см. в статье [Статистические выражения в Power BI](../create-reports/service-aggregates.md).


    > [!NOTE]
    > В Power BI Desktop вы можете экспортировать только сводные данные. 
    
    
1. В разделе **Экспорт данных** выберите **Базовые данные**, а затем выберите **Экспорт**. Power BI экспортирует данные.

    ![Снимок экрана: окно "Экспорт данных" с вызываемыми базовыми данными.](media/power-bi-visualization-export-data/power-bi-underlying.png)

1. При выборе элемента **Экспорт** браузер предложит сохранить файл. Откройте сохраненный файл в программе Excel.

    ![Снимок экрана: файл XLSX, отображающий экспортированные данные.](media/power-bi-visualization-export-data/power-bi-excel.png)
    
    - На этом снимке экрана показана только небольшая часть файла Excel. Он содержит более 100 000 строк.  
    
    - Экспортируются все данные, используемые иерархией, а не только данные, используемые для текущего уровня детализации визуального элемента. Например, мы выполняли детализацию по уровню City, но наш экспорт включает также данные о стране.  

    - Так как мы применили фильтры к визуализации, экспортированные данные будут экспортированы с учетом фильтров. Обратите внимание, что первая строка отображает **Примененные фильтры: город — не Атланта, штат Джорджия**. 

## <a name="protecting-proprietary-data"></a>Защита конфиденциальных данных

В наборе данных может быть содержимое, которое не должно отображаться для всех пользователей. Если не соблюдать осторожность, в результате экспорта базовых данных пользователи смогут увидеть все подробные данные для этого визуального элемента — каждый столбец и каждую строку данных. 

Существует несколько стратегий Power BI, которые администраторы и создатели должны использовать для защиты конфиденциальных данных. 

- Создатели [решают, какие *параметры экспорта*](#set-the-export-options) доступны пользователям.  

- Администраторы Power BI могут отключить экспорт данных для своей организации. 

- Владельцы наборов данных могут устанавливать безопасность на уровне строк (RLS). RLS предоставляет пользователям доступ только для чтения. Но если вы настроили рабочую область приложения и дали ее участникам разрешения на изменение, то роли RLS не будут применяться к этим участникам. Дополнительные сведения см. в разделе [Безопасность на уровне строк](../admin/service-admin-rls.md).

- Создатели отчетов могут скрывать столбцы, чтобы они не отображались в списке **Поля**. Дополнительные сведения см. в разделе [Свойства наборов данных](../developer/automation/api-dataset-properties.md)

- Администраторы Power BI могут добавлять [метки конфиденциальности](../admin/service-security-data-protection-overview.md) к панелям мониторинга, отчетам, наборам данных и потокам данных. Затем они могут применять параметры защиты, такие как шифрование или водяные знаки, при экспорте данных. 

- Администраторы Power BI могут использовать [Microsoft Cloud App Security](../admin/service-security-data-protection-overview.md), чтобы отслеживать доступ пользователей и осуществляемые ими действия, выполнять анализ рисков в реальном времени, а также задавать элементы управления для меток. Например, организации могут использовать Microsoft Cloud App Security для настройки политики, запрещающей пользователям скачивать конфиденциальные данные из Power BI на неуправляемые устройства. 


## <a name="export-underlying-data-details"></a>Сведения об экспорте базовых данных

Данные, отображаемые при выборе варианта **Базовые данные**, могут различаться. Для понимания этих сведений может потребоваться помощь администратора или ИТ-отдела. 


>



| Визуальный элемент содержит | Что вы видите при экспорте  |
|---------------- | ---------------------------|
| Статистические выражения | *Первое* статистическое выражение и нескрытые данные из всей таблицы для этого статистического выражения |
| Статистические выражения | Связанные данные — если визуальный элемент использует данные из других таблиц данных, которые *связаны* с таблицей данных, содержащей статистическое выражение (если это связь типа \*: 1 или 1:1) |
| Меры* | Все меры в визуальном элементе *и* все меры из любой таблицы данных, содержащей меру, используемую в визуальном элементе |
| Меры* | Все нескрытые данные из таблиц, содержащих эту меру (если это связь типа \*: 1 или 1:1) |
| Меры* | Все данные из всех таблиц, связанных с таблицей, содержащей меры с помощью цепочки \*: 1 из 1:1 |
| Только меры | Все нескрытые столбцы из всех связанных таблиц (для расширения меры) |
| Только меры | Сводные данные для всех повторяющихся строк для мер модели |

\* В Power BI Desktop или в службе Power BI в представлении отчетов *мера* отображается в списке **Поля** со значком калькулятора ![отображение значка](media/power-bi-visualization-export-data/power-bi-calculator-icon.png). Меры можно создавать в Power BI Desktop.

### <a name="set-the-export-options"></a>Настройка параметров экспорта

Конструкторы отчетов Power BI управляют типами параметров экспорта данных, которые доступны для пользователей. Доступные варианты:

- Разрешить пользователям экспортировать сводные данные из службы Power BI или Сервера отчетов Power BI

- Разрешить пользователям экспортировать сводные и базовые данные из службы или Сервера отчетов

- Запретить пользователям экспортировать данные из службы или Сервера отчетов

    > [!IMPORTANT]
    > Мы рекомендуем конструкторам отчетов вернуться к старым отчетам и вручную сбросить параметр экспорта при необходимости.

Чтобы настроить эти параметры, сделайте следующее:

1. Запустите Power BI Desktop.

1. В левом верхнем углу выберите **Файл** > **Параметры и настройки** > **Параметры**.

1. В разделе **ТЕКУЩИЙ ФАЙЛ** выберите **Параметры отчета**.

    ![Параметры отчетов](media/power-bi-visualization-export-data/desktop-report-settings.png)

1. Выберите нужный вариант в разделе **Экспорт данных**.

Этот параметр также можно обновить в службе Power BI.

Учтите, что конфликтующие параметры портала администрирования Power BI переопределяют параметры отчета для экспорта данных.

## <a name="limitations-and-considerations"></a>Рекомендации и ограничения
Эти ограничения и рекомендации применяются к Power BI Desktop и службе Power BI, включая Power BI Pro и Premium.

- Чтобы экспортировать данные из визуального элемента, вам нужно иметь [разрешение на сборку для базового набора данных](https://docs.microsoft.com/power-bi/service-datasets-build-permissions).

-  Максимальное число строк, которые **Power BI Desktop** и **служба Power BI** могут экспортировать из **отчета режима импорта** в файл *CSV*, составляет 30 000.

- Максимальное число строк, которые приложения могут экспортировать из **отчета режима импорта** в файл *XLSX*, составляет 150 000.

- Экспорт с использованием *базовых данных* не будет выполняться, если:

  - используется более ранняя версия, чем версия 2016;

  - для таблиц в модели нет уникального ключа;
    
  -  администратор или конструктор отчетов отключил эту функцию.

- Экспорт с использованием *базовых данных* не будет работать, если вы включите параметр *Показать элементы без данных*.для визуализации, которую экспортирует Power BI.

- При использовании DirectQuery максимальный объем данных, который Power BI может экспортировать, составляет 16 МБ несжатых данных. Непреднамеренным результатом может быть то, что вы экспортируете меньше, чем максимальное количество строк (150 000). Это вероятно, если:

    - существует много столбцов;

    - существуют данные, которые сложно сжать;

    - существуют другие факторы, из-за которых увеличивается размер файла и уменьшается количество строк, которые Power BI может экспортировать.

- Если визуализация использует данные из нескольких таблиц данных и для этих таблиц в модели данных не существует связей, Power BI экспортирует только данные для первой таблицы.

- Визуальные элементы Power BI и визуальные элементы R пока не поддерживаются.

- В Power BI вы можете переименовать поле (столбец), дважды щелкнув его и введя новое имя. Power BI рассматривает новое имя как *псевдоним*. В отчете Power BI в итоге могут оказаться повторяющиеся имена полей, однако в Excel они запрещены. Поэтому когда Power BI экспортирует данные в Excel, псевдонимы заменяются исходными именами полей (столбцов).  

- Если в файле *CSV* содержатся знаки Юникода, то текст в Excel может отображаться неправильно. Примерами знаков Юникода являются символы валют и иностранные слова. Вы можете открыть файл в Блокноте, чтобы знаки Юникода отобразились правильно. Если вы хотите открыть файл в Excel, необходимо импортировать файл *CSV*. Чтобы импортировать файл в Excel, сделайте следующее:

  1. Откройте Excel.

  1. Перейдите на вкладку **Данные**.
  
  1. Выберите **Получение внешних данных** > **Из текста**.
  
  1. Перейдите к локальной папке, где хранится файл, и выберите файл *CSV*.

- При экспорте в *.csv* некоторые символы будут экранированы с **'** в начале.

- Администраторы Power BI могут отключить экспорт данных.

Появились дополнительные вопросы? [Попробуйте задать вопрос в сообществе Power BI.](https://community.powerbi.com/)
